Load the NCBI GEO single-cell RNA-seq dataset GSE182298 located at `benchmark/dataset/SCovid/GSE182298`.'

Perform Quality Control (QC) filtering with the following strict criteria:

Filter out cells that have fewer than 200 detected genes.

Filter out genes that are detected in fewer than 3 cells.

Calculate the percentage of mitochondrial genes (genes starting with prefix "MT-") for each cell.

Apply the tissue-specific mitochondrial filtering rule: If the input tissue is Liver, remove cells with a mitochondrial gene proportion > 50%. (Note: For non-liver tissues, the threshold would be > 20%).

Save the list of remaining valid cell barcodes to a CSV file named /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/qc_passed_barcodes.csv (single column, no header).

All temp data should be save in `/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/scovid_refinement`.

Output Format (For Reference)
```
<GSMID1>_barcode1
<GSMID2>_barcode2
...

<execute>#!BASH
ls -la benchmark/dataset/SCovid/GSE182298
</execute>
<observation>total 245076
drwxr-xr-x 2 root root     4096 Feb  7 04:56 .
drwxr-xr-x 3 root root       31 Feb  3 21:38 ..
-rw-rw-r-- 1 9017 5007    63642 Jul 27  2021 GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc-barcodes.tsv.gz
-rw-rw-r-- 1 9017 5007   304728 Jul 27  2021 GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc-features.tsv.gz
-rw-rw-r-- 1 9017 5007 85851186 Jul 27  2021 GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc-matrix.mtx.gz
-rw-rw-r-- 1 9017 5007    59497 Jul 27  2021 GSM5526329_92_NxtG_Olfactory_Bulb_3_COVID_MA_20_89-premrna-3prime-filtered-bc-barcodes.tsv.gz
-rw-rw-r-- 1 9017 5007   304728 Jul 27  2021 GSM5526329_92_NxtG_Olfactory_Bulb_3_COVID_MA_20_89-premrna-3prime-filtered-bc-features.tsv.gz
-rw-rw-r-- 1 9017 5007 81838806 Jul 27  2021 GSM5526329_92_NxtG_Olfactory_Bulb_3_COVID_MA_20_89-premrna-3prime-filtered-bc-matrix.mtx.gz
-rw-rw-r-- 1 9017 5007    45480 Jul 27  2021 GSM5526330_87_NxtG_Frontal_Lobe_1_COVID_MA_20_89-premrna-3prime-filtered-bc-barcodes.tsv.gz
-rw-rw-r-- 1 9017 5007   304728 Jul 27  2021 GSM5526330_87_NxtG_Frontal_Lobe_1_COVID_MA_20_89-premrna-3prime-filtered-bc-features.tsv.gz
-rw-rw-r-- 1 9017 5007 27736909 Jul 27  2021 GSM5526330_87_NxtG_Frontal_Lobe_1_COVID_MA_20_89-premrna-3prime-filtered-bc-matrix.mtx.gz
-rw-rw-r-- 1 9017 5007    50064 Jul 27  2021 GSM5526331_88_NxtG_Frontal_Lobe_2_COVID_MA_20_89-premrna-3prime-filtered-bc-barcodes.tsv.gz
-rw-rw-r-- 1 9017 5007   304728 Jul 27  2021 GSM5526331_88_NxtG_Frontal_Lobe_2_COVID_MA_20_89-premrna-3prime-filtered-bc-features.tsv.gz
-rw-rw-r-- 1 9017 5007 31245854 Jul 27  2021 GSM5526331_88_NxtG_Frontal_Lobe_2_COVID_MA_20_89-premrna-3prime-filtered-bc-matrix.mtx.gz
-rw-rw-r-- 1 9017 5007    40120 Jul 27  2021 GSM5526332_89_NxtG_Frontal_Lobe_3_COVID_MA_20_89-premrna-3prime-filtered-bc-barcodes.tsv.gz
-rw-rw-r-- 1 9017 5007   304728 Jul 27  2021 GSM5526332_89_NxtG_Frontal_Lobe_3_COVID_MA_20_89-premrna-3prime-filtered-bc-features.tsv.gz
-rw-rw-r-- 1 9017 5007 22464042 Jul 27  2021 GSM5526332_89_NxtG_Frontal_Lobe_3_COVID_MA_20_89-premrna-3prime-filtered-bc-matrix.mtx.gz
</observation>
<execute>
import os
import scanpy as sc
import pandas as pd

# Create temp directory
temp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/scovid_refinement"
os.makedirs(temp_dir, exist_ok=True)

# Output file path
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/qc_passed_barcodes.csv"
os.makedirs(os.path.dirname(output_file), exist_ok=True)

# Dataset directory
data_dir = "benchmark/dataset/SCovid/GSE182298"

# List all GSM samples
samples = [
    "GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526329_92_NxtG_Olfactory_Bulb_3_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526330_87_NxtG_Frontal_Lobe_1_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526331_88_NxtG_Frontal_Lobe_2_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526332_89_NxtG_Frontal_Lobe_3_COVID_MA_20_89-premrna-3prime-filtered-bc"
]

all_valid_barcodes = []

for sample in samples:
    gsm_id = sample.split("_")[0]
    print(f"Processing {gsm_id}...")
    
    # Load 10x data
    adata = sc.read_10x_mtx(
        os.path.join(data_dir),
        prefix=f"{sample}_",
        var_names='gene_symbols',
        cache=False
    )
    
    # QC: Filter cells with <200 genes
    sc.pp.filter_cells(adata, min_genes=200)
    
    # QC: Filter genes detected in <3 cells
    sc.pp.filter_genes(adata, min_cells=3)
    
    # Calculate mitochondrial percentage
    adata.var['mt'] = adata.var_names.str.startswith('MT-')
    sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
    
    # Filter mitochondrial percentage: >20% (non-liver tissue)
    adata = adata[adata.obs['pct_counts_mt'] < 20, :]
    
    # Collect valid barcodes with GSM prefix
    valid_barcodes = [f"{gsm_id}_{barcode}" for barcode in adata.obs_names]
    all_valid_barcodes.extend(valid_barcodes)
    
    # Save temp adata if needed
    adata.write(os.path.join(temp_dir, f"{gsm_id}_qc_filtered.h5ad"))
    print(f"  Kept {len(valid_barcodes)} cells")

# Save all valid barcodes to CSV
pd.DataFrame(all_valid_barcodes).to_csv(output_file, index=False, header=False)
print(f"\nTotal valid barcodes: {len(all_valid_barcodes)}")
print(f"Saved to {output_file}")
</execute>
<observation>FileNotFoundError('Did not find file benchmark/dataset/SCovid/GSE182298/GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc_matrix.mtx.gz.')</observation>
<execute>
import os
import scanpy as sc
import pandas as pd

# Create temp directory
temp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/scovid_refinement"
os.makedirs(temp_dir, exist_ok=True)

# Output file path
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/qc_passed_barcodes.csv"
os.makedirs(os.path.dirname(output_file), exist_ok=True)

# Dataset directory
data_dir = "benchmark/dataset/SCovid/GSE182298"

# List all GSM samples
samples = [
    "GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526329_92_NxtG_Olfactory_Bulb_3_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526330_87_NxtG_Frontal_Lobe_1_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526331_88_NxtG_Frontal_Lobe_2_COVID_MA_20_89-premrna-3prime-filtered-bc",
    "GSM5526332_89_NxtG_Frontal_Lobe_3_COVID_MA_20_89-premrna-3prime-filtered-bc"
]

all_valid_barcodes = []

for sample in samples:
    gsm_id = sample.split("_")[0]
    print(f"Processing {gsm_id}...")
    
    # Load each file separately
    matrix_path = os.path.join(data_dir, f"{sample}-matrix.mtx.gz")
    features_path = os.path.join(data_dir, f"{sample}-features.tsv.gz")
    barcodes_path = os.path.join(data_dir, f"{sample}-barcodes.tsv.gz")
    
    adata = sc.read_mtx(matrix_path).T
    features = pd.read_csv(features_path, sep='\t', header=None)
    barcodes = pd.read_csv(barcodes_path, sep='\t', header=None)
    
    # Set gene names and cell barcodes
    adata.var_names = features[1]  # Use gene symbols
    adata.obs_names = barcodes[0]
    
    # QC: Filter cells with <200 genes
    sc.pp.filter_cells(adata, min_genes=200)
    
    # QC: Filter genes detected in <3 cells
    sc.pp.filter_genes(adata, min_cells=3)
    
    # Calculate mitochondrial percentage
    adata.var['mt'] = adata.var_names.str.startswith('MT-')
    sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
    
    # Filter mitochondrial percentage: >20% (non-liver tissue)
    adata = adata[adata.obs['pct_counts_mt'] < 20, :]
    
    # Collect valid barcodes with GSM prefix
    valid_barcodes = [f"{gsm_id}_{barcode}" for barcode in adata.obs_names]
    all_valid_barcodes.extend(valid_barcodes)
    
    # Save temp adata
    adata.write(os.path.join(temp_dir, f"{gsm_id}_qc_filtered.h5ad"))
    print(f"  Kept {len(valid_barcodes)} cells")

# Save all valid barcodes to CSV
pd.DataFrame(all_valid_barcodes).to_csv(output_file, index=False, header=False)
print(f"\nTotal valid barcodes: {len(all_valid_barcodes)}")
print(f"Saved to {output_file}")
</execute>
<observation>NameError("name 'gsm_id' is not defined")</observation>
<execute>
import os
import scanpy as sc
import pandas as pd

# Create temp directory
temp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/scovid_refinement"
os.makedirs(temp_dir, exist_ok=True)

# Output file path
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/qc_passed_barcodes.csv"
os.makedirs(os.path.dirname(output_file), exist_ok=True)

# Dataset directory
data_dir = "benchmark/dataset/SCovid/GSE182298"

# Process each GSM sample
all_valid_barcodes = []

# GSM5526328: Olfactory Bulb
print("Processing GSM5526328...")
sample = "GSM5526328_91_NxtG_Olfactory_Bulb_2_COVID_MA_20_89-premrna-3prime-filtered-bc"
adata = sc.read_mtx(os.path.join(data_dir, f"{sample}-matrix.mtx.gz")).T
features = pd.read_csv(os.path.join(data_dir, f"{sample}-features.tsv.gz"), sep='\t', header=None)
barcodes = pd.read_csv(os.path.join(data_dir, f"{sample}-barcodes.tsv.gz"), sep='\t', header=None)
adata.var_names = features[1]
adata.obs_names = barcodes[0]
sc.pp.filter_cells(adata, min_genes=200)
sc.pp.filter_genes(adata, min_cells=3)
adata.var['mt'] = adata.var_names.str.startswith('MT-')
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
adata = adata[adata.obs['pct_counts_mt'] < 20, :]
valid_barcodes = [f"GSM5526328_{barcode}" for barcode in adata.obs_names]
all_valid_barcodes.extend(valid_barcodes)
adata.write(os.path.join(temp_dir, "GSM5526328_qc_filtered.h5ad"))
print(f"  Kept {len(valid_barcodes)} cells")

# GSM5526329: Olfactory Bulb
print("Processing GSM5526329...")
sample = "GSM5526329_92_NxtG_Olfactory_Bulb_3_COVID_MA_20_89-premrna-3prime-filtered-bc"
adata = sc.read_mtx(os.path.join(data_dir, f"{sample}-matrix.mtx.gz")).T
features = pd.read_csv(os.path.join(data_dir, f"{sample}-features.tsv.gz"), sep='\t', header=None)
barcodes = pd.read_csv(os.path.join(data_dir, f"{sample}-barcodes.tsv.gz"), sep='\t', header=None)
adata.var_names = features[1]
adata.obs_names = barcodes[0]
sc.pp.filter_cells(adata, min_genes=200)
sc.pp.filter_genes(adata, min_cells=3)
adata.var['mt'] = adata.var_names.str.startswith('MT-')
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
adata = adata[adata.obs['pct_counts_mt'] < 20, :]
valid_barcodes = [f"GSM5526329_{barcode}" for barcode in adata.obs_names]
all_valid_barcodes.extend(valid_barcodes)
adata.write(os.path.join(temp_dir, "GSM5526329_qc_filtered.h5ad"))
print(f"  Kept {len(valid_barcodes)} cells")

# GSM5526330: Frontal Lobe
print("Processing GSM5526330...")
sample = "GSM5526330_87_NxtG_Frontal_Lobe_1_COVID_MA_20_89-premrna-3prime-filtered-bc"
adata = sc.read_mtx(os.path.join(data_dir, f"{sample}-matrix.mtx.gz")).T
features = pd.read_csv(os.path.join(data_dir, f"{sample}-features.tsv.gz"), sep='\t', header=None)
barcodes = pd.read_csv(os.path.join(data_dir, f"{sample}-barcodes.tsv.gz"), sep='\t', header=None)
adata.var_names = features[1]
adata.obs_names = barcodes[0]
sc.pp.filter_cells(adata, min_genes=200)
sc.pp.filter_genes(adata, min_cells=3)
adata.var['mt'] = adata.var_names.str.startswith('MT-')
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
adata = adata[adata.obs['pct_counts_mt'] < 20, :]
valid_barcodes = [f"GSM5526330_{barcode}" for barcode in adata.obs_names]
all_valid_barcodes.extend(valid_barcodes)
adata.write(os.path.join(temp_dir, "GSM5526330_qc_filtered.h5ad"))
print(f"  Kept {len(valid_barcodes)} cells")

# GSM5526331: Frontal Lobe
print("Processing GSM5526331...")
sample = "GSM5526331_88_NxtG_Frontal_Lobe_2_COVID_MA_20_89-premrna-3prime-filtered-bc"
adata = sc.read_mtx(os.path.join(data_dir, f"{sample}-matrix.mtx.gz")).T
features = pd.read_csv(os.path.join(data_dir, f"{sample}-features.tsv.gz"), sep='\t', header=None)
barcodes = pd.read_csv(os.path.join(data_dir, f"{sample}-barcodes.tsv.gz"), sep='\t', header=None)
adata.var_names = features[1]
adata.obs_names = barcodes[0]
sc.pp.filter_cells(adata, min_genes=200)
sc.pp.filter_genes(adata, min_cells=3)
adata.var['mt'] = adata.var_names.str.startswith('MT-')
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
adata = adata[adata.obs['pct_counts_mt'] < 20, :]
valid_barcodes = [f"GSM5526331_{barcode}" for barcode in adata.obs_names]
all_valid_barcodes.extend(valid_barcodes)
adata.write(os.path.join(temp_dir, "GSM5526331_qc_filtered.h5ad"))
print(f"  Kept {len(valid_barcodes)} cells")

# GSM5526332: Frontal Lobe
print("Processing GSM5526332...")
sample = "GSM5526332_89_NxtG_Frontal_Lobe_3_COVID_MA_20_89-premrna-3prime-filtered-bc"
adata = sc.read_mtx(os.path.join(data_dir, f"{sample}-matrix.mtx.gz")).T
features = pd.read_csv(os.path.join(data_dir, f"{sample}-features.tsv.gz"), sep='\t', header=None)
barcodes = pd.read_csv(os.path.join(data_dir, f"{sample}-barcodes.tsv.gz"), sep='\t', header=None)
adata.var_names = features[1]
adata.obs_names = barcodes[0]
sc.pp.filter_cells(adata, min_genes=200)
sc.pp.filter_genes(adata, min_cells=3)
adata.var['mt'] = adata.var_names.str.startswith('MT-')
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
adata = adata[adata.obs['pct_counts_mt'] < 20, :]
valid_barcodes = [f"GSM5526332_{barcode}" for barcode in adata.obs_names]
all_valid_barcodes.extend(valid_barcodes)
adata.write(os.path.join(temp_dir, "GSM5526332_qc_filtered.h5ad"))
print(f"  Kept {len(valid_barcodes)} cells")

# Save all valid barcodes to CSV
pd.DataFrame(all_valid_barcodes).to_csv(output_file, index=False, header=False)
print(f"\nTotal valid barcodes: {len(all_valid_barcodes)}")
print(f"Saved to {output_file}")
</execute>
<observation>Processing GSM5526328...
  Kept 9875 cells
Processing GSM5526329...
  Kept 9231 cells
Processing GSM5526330...
  Kept 6742 cells
Processing GSM5526331...
  Kept 6819 cells
Processing GSM5526332...
  Kept 6633 cells

Total valid barcodes: 39300
Saved to /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/qc_passed_barcodes.csv
</observation>
<solution>
The Quality Control (QC) filtering has been completed successfully. A total of 39,300 valid cell barcodes passed all filtering criteria.

The valid barcodes are saved in the CSV file at:
/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/qc_passed_barcodes.csv

Temporary filtered AnnData objects for each GSM sample are saved in:
/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/scovid_refinement/
</solution>