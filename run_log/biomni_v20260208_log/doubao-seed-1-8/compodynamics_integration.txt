Process the provided CDS sequences in `benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna`. 

Filter out sequences that meet any of the following criteria: 1) length is not a multiple of 3; 2) does not start with an "ATG" codon; 3) does not end with a standard stop codon ("TAA", "TAG", or "TGA"); 4) contains an internal stop codon. 

Save the remaining valid sequences to `/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna`.

All temp data should be save in `/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/compodynamics_integration`.

<execute>#!BASH
ls -la benchmark/dataset/CompoDynamics/
</execute>
<observation>total 4320
drwxr-xr-x  3 root root    4096 Feb  7 06:06 .
drwxr-xr-x 48 root root    4096 Feb  8 20:44 ..
drwxr-xr-x  2 root root     163 Feb  4 16:58 GCF_000007005.1
-rw-r--r--  1 root root 2602514 Feb  4 16:58 GCF_009428885.1_ASM942888v1_cds_from_genomic.fna
-rw-r--r--  1 root root  171280 Feb  4 16:58 GCF_009428885.1_ASM942888v1_cds_from_genomic.fna.fai
-rw-r--r--  1 root root 1631733 Feb  7 06:06 GCF_009428885.1_ASM942888v1_genomic.gff
-rw-r--r--  1 root root     139 Feb  4 16:58 raw_cds.fna
</observation>
<execute>#!BASH
mkdir -p /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/compodynamics_integration
mkdir -p /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8
</execute>
<observation></observation>
<execute>
from Bio import SeqIO
import os

# Input file path
input_file = "benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna"
# Temp directory
temp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/compodynamics_integration"
# Output file path
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna"

# Create temp directory if not exists
os.makedirs(temp_dir, exist_ok=True)

# Stop codons
stop_codons = {"TAA", "TAG", "TGA"}

valid_sequences = []
invalid_counts = {
    "length_not_multiple_of_3": 0,
    "no_start_codon": 0,
    "no_stop_codon": 0,
    "internal_stop_codon": 0
}

# Process each sequence
for record in SeqIO.parse(input_file, "fasta"):
    seq = str(record.seq).upper()
    valid = True
    
    # Check 1: Length is multiple of 3
    if len(seq) % 3 != 0:
        invalid_counts["length_not_multiple_of_3"] += 1
        valid = False
    else:
        # Check 2: Starts with ATG
        if not seq.startswith("ATG"):
            invalid_counts["no_start_codon"] += 1
            valid = False
        else:
            # Check 3: Ends with stop codon
            stop_codon = seq[-3:]
            if stop_codon not in stop_codons:
                invalid_counts["no_stop_codon"] += 1
                valid = False
            else:
                # Check 4: No internal stop codons
                # Remove the stop codon before checking
                coding_seq = seq[:-3]
                for i in range(0, len(coding_seq), 3):
                    codon = coding_seq[i:i+3]
                    if codon in stop_codons:
                        invalid_counts["internal_stop_codon"] += 1
                        valid = False
                        break
    
    if valid:
        valid_sequences.append(record)

# Save valid sequences to output file
SeqIO.write(valid_sequences, output_file, "fasta")

# Save invalid counts to temp file
with open(os.path.join(temp_dir, "invalid_counts.txt"), "w") as f:
    for reason, count in invalid_counts.items():
        f.write(f"{reason}: {count}\n")

# Print summary
total_sequences = len(list(SeqIO.parse(input_file, "fasta")))
valid_count = len(valid_sequences)
print(f"Total sequences: {total_sequences}")
print(f"Valid sequences: {valid_count}")
print("Invalid counts:")
for reason, count in invalid_counts.items():
    print(f"  {reason}: {count}")
print(f"Valid sequences saved to: {output_file}")
print(f"Invalid counts saved to: {os.path.join(temp_dir, 'invalid_counts.txt')}")
</execute>
<observation>Total sequences: 2701
Valid sequences: 1984
Invalid counts:
  length_not_multiple_of_3: 54
  no_start_codon: 642
  no_stop_codon: 14
  internal_stop_codon: 7
Valid sequences saved to: /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna
Invalid counts saved to: /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/compodynamics_integration/invalid_counts.txt
</observation>
<execute>#!BASH
# Check output file exists and has content
ls -la /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna
# Check first few sequences
head -20 /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna
</execute>
<observation>-rw-r--r-- 1 root root 1953189 Feb  9 00:56 /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna
>lcl|NZ_WHYS01000010.1_cds_WP_152943598.1_2 [locus_tag=GFB69_RS13175] [protein=RAMP superfamily CRISPR-associated protein] [protein_id=WP_152943598.1] [location=966..1763] [gbkey=CDS]
ATGCAAGGATTCAATACCCAATGTAAATCTGAACCCACTCCTAGAAATATAGGAGAAAAG
AGGAGAGTTCACGTAAAGATTAGCGTAGTGTCTGAGTACTTTCACGTTTCGCAAAATCCT
AAGCCGATGCCGTTAATAGAGGAAAAGAATGCAAACTCAATTATTTCCCAATTCCTACAG
ACTGGAAGAGCCAACGTTTTCGTTGAGAGGGACGCAGTCTATTTTACCAGAGTAGGGGAA
GATATAGTTATTCCAGCAAACACTGTTAGAGGGGCAGTAAGGAGTAGGCTTGAAGTGCTA
TTTGATTGCTCTTGTTATAATTCACTAGGTAATAGGCCTTCCGCATCCATCTCTAGAAAA
TATAAGGAAATATTCAAACCTAGAAGGAAGTACAGCGATGACCTAGAAAGAGAAGGCAAA
GTTTGCCCTGTATGTAACGTTTTCGGCACTGCGGGTCTAGCTAGTAGGATAACTTTTACG
GACTTCAAATTAACAGCTGGCAAAGTGGACTACGTTAATGTCCAAGGTTATACTTACGAG
GTTGCAACTAAGGGTTCAGTATTTGAAGGTGATGTAATAGGTAACCTTAGCAGAGAGGAG
TGGGGAATGGTTCTGTGGGGTATGGGTTGTAGGAAGGGTAAGTTTAAGGTGATTTTGATG
GGCAGATTTAAGTTCCAGAGGAGGGACTTTGCTAGGGTTAAATTTGAGGTTAACGATCAG
GACTTAATTAGTGCTTGCGTGGAATTTGAAACTAAGTACTCCAAGTACTTGCACGACGTG
GAGGAGGATTGGAAATGA
>lcl|NZ_WHYS01000010.1_cds_WP_282958799.1_3 [locus_tag=GFB69_RS14395] [protein=hypothetical protein] [protein_id=WP_282958799.1] [location=1760..1885] [gbkey=CDS]
ATGAGAATTTGCATTAAGAGGGATCTCTCAATTACCTTTGAAGAGAAGGAATGCGTTAAG
GTAGTTGAACTAGAGGAGAATGATGGAAAATTGAAAGCAGGGGACGTTGAGTACTTGAAG
GGGTGA
>lcl|NZ_WHYS01000013.1_cds_WP_152943608.1_8 [locus_tag=GFB69_RS13200] [protein=hypothetical protein] [protein_id=WP_152943608.1] [location=1304..1642] [gbkey=CDS]
</observation>
<execute>#!BASH
cat /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/compodynamics_integration/invalid_counts.txt
</execute>
<observation>length_not_multiple_of_3: 54
no_start_codon: 642
no_stop_codon: 14
internal_stop_codon: 7
</observation>
<solution>
## CDS Sequence Processing Summary

### Input File:
`benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna`

### Filtering Criteria Applied:
1. ✅ Removed sequences with length not multiple of 3: 54 sequences
2. ✅ Removed sequences not starting with "ATG": 642 sequences
3. ✅ Removed sequences not ending with standard stop codon (TAA/TAG/TGA): 14 sequences
4. ✅ Removed sequences containing internal stop codons: 7 sequences

### Results:
- **Total sequences processed**: 2701
- **Valid sequences retained**: 1984
- **Valid sequences saved to**: `/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/compodynamics_integration.fna`
- **Invalid counts saved to**: `/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/compodynamics_integration/invalid_counts.txt`
</solution>