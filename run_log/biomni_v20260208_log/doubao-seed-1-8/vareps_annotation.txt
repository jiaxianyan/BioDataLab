There are a list of possible single amino acid mutations for protein in `benchmark/dataset/VarEPS/4KMN.pdb`. The mutations are as listed in file `benchmark/dataset/VarEPS/mutation_list.txt`.

Identify the most stable mutation among the list of possible mutations by saambe-3d. 

Save the most stable mutation and its corresponding ΔΔG value to `/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt`.

All temp data should be save in `/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/vareps_annotation`.

Output format (For Reference):
A 415 Q T

First, let's verify the existence of the input files and explore the SAAMBE-3D tool:

<execute>#!BASH
# Check if input files exist
ls -la benchmark/dataset/VarEPS/

# Explore SAAMBE-3D directory to understand usage
ls -la operation_env/SAAMBE-3D-master/
cat operation_env/SAAMBE-3D-master/README.md | head -50
</execute>
<observation>total 248
drwxr-xr-x  2 root root     59 Feb  4 02:26 .
drwxr-xr-x 48 root root   4096 Feb  8 20:44 ..
-rw-r--r--  1 root root 244458 Feb  4 02:22 4KMN.pdb
-rw-r--r--  1 root root     50 Feb  4 02:30 mutation_list.txt
total 25408
drwxr-xr-x 3 root root     4096 Feb  7 05:14 .
drwxr-xr-x 5 root root       91 Feb  6 01:53 ..
-rw-r--r-- 1 root root     2848 Aug  8  2024 .gitignore
-rw-r--r-- 1 root root   292005 Aug  8  2024 1a22.pdb
-rw-r--r-- 1 root root   244458 Feb  8 22:45 4KMN.pdb
-rw-r--r-- 1 root root    35149 Aug  8  2024 LICENSE
-rw-r--r-- 1 root root     4520 Aug  8  2024 README.md
-rw-r--r-- 1 root root     3050 Aug  8  2024 amino-acids-properties.csv
-rw-r--r-- 1 root root   492893 Aug  8  2024 classification.model
-rw-r--r-- 1 root root   492994 Aug  8  2024 classification_v01.model
-rw-r--r-- 1 root root     2505 Aug  8  2024 environment.yml
-rw-r--r-- 1 root root       50 Feb  8 22:45 mutation_list.txt
-rw-r--r-- 1 root root       65 Aug  8  2024 mutations_list.txt
-rw-r--r-- 1 root root      251 Feb  8 22:45 output.out
-rw-r--r-- 1 root root      251 Feb  7 05:14 predictions.out
-rw-r--r-- 1 root root 12193584 Aug  8  2024 regression.model
-rw-r--r-- 1 root root 12193686 Aug  8  2024 regression_v01.model
-rw-r--r-- 1 root root    17403 Aug  8  2024 saambe-3d.py
drwxr-xr-x 3 root root       85 Jan 29 15:51 utils
#  SAAMBE-3D: Predicting Effect of Mutations on Protein–Protein Interactions.
# About
SAAMBE-3D is a tool written in python 3, it is tested to work with python3.7. SAAMBE-3D implements a structure based mathod for predicting the binding free energy change for protein-protein due to a point-mutation. It requires the 3D structure in PDB of the protein-protein complex as input and information about the mutation to make the prediction.
##### SAMMBE 3D can be used to :
- i) predict the binding free energy change caused by single mutation, and
- ii) predict whether a particular mutation is disruptive or non-disruptive.

# Dependepcies
SAAMBE-3D requires following packages and mentioned versions to be installed in the python (Python 3.11.5) to work
- numpy (1.26.0)
- prody (2.4.0)
- xgboost (1.7.6)

It has been tested to work on a machine running Ubunutu 22.04.3. The python is mainted using conda 23.7.2. We created a python environment for SAAMBE-3D using:
```sh
conda create -n py311_saambe3d python=3.11
```
Then if any conda environment is already active deactivate it using:
```sh
conda deactivate
```
Activate the conda python environemnt created above using:
```sh
conda activate py311_saambe3d
```
All the above versions of packages are installed using following commands.
```sh
conda install -c conda-forge numpy=1.26.0
conda install -c conda-forge prody=2.4.0
conda install -c conda-forge xgboost=1.7.6
```
downgrade the pyparsing to 3.1.1 if higher version installed, as it leads to error
in selection parsing using prody. One can use below command for it.
```
conda install -c conda-forge pyparsing==3.1.1
```
## Alternatively, create python environment from environment.yaml.
Alternatively one can create the python enviroment `py311_saambe3d` from the 
environment.yaml file using command:
```
conda env create --file=environment.yml
```


# Prediction Models
The method provides two different models for predictions:
- regression.model (for predicting: binding free energy change)
- classification.model (for prediction: if the mutation is disruptive or non-disruptive)

# How to run
</observation>
<execute>#!BASH
cat operation_env/SAAMBE-3D-master/README.md | grep -A 30 "How to run"
</execute>
<observation># How to run
To have a look at and familiarize yourself with all the options supported use:
```sh
python saambe-3d.py --help
```
The SAAMBE-3D can be run for a single point mutation by executing following command from inside of the SAAMBE-3D directory:
```sh
python saambe-3d.py -i PDBfile -c Chain -r Resid -w wild -m mutation -d model
```
To make predictionsof a list of point-mutations execute:

```sh
saambe-3d.py -i PDBfile -f mutation_list -d model
```
# Example
##### Single point-mutation:
For example if user want to predict binding free energy for protein-protein complex with PDB ID 1A22 due to mutation from Cysteine (C) to Alanine (A) at res ID 182 in chain A, they should run the script by typing

```sh
python saambe-3d.py -i 1A22.pdb -c A -r 182 -w C -m A -d 1
```
After running it check the file *`output.out`* or the file name if you provided any with ```sammbe-3d.py -o option``` for the output.

#### List of point-mutations.
If user want to get multiple predictions for many single mutations at the same complex, user can provide a file
say `mutations_list.txt`, which should be formatted as follows for the above example.
The columns in the mutation list file are: `ChainID` `resID` `wildtype_residue` `mutant_residue`
```sh
A 182 C A   
```
and the command will be:
</observation>
Let me check the format of our mutation list file first:

<execute>#!BASH
cat benchmark/dataset/VarEPS/mutation_list.txt
</execute>
<observation>A 303 C A
A 304 D A
A 305 G A
A 306 G A
A 307 L A
</observation>
Now let's prepare the temp directory and run SAAMBE-3D on our mutation list:

<execute>#!BASH
# Create temp directory
mkdir -p /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/vareps_annotation

# Copy input files to SAAMBE-3D directory (or we can use absolute paths)
cp benchmark/dataset/VarEPS/4KMN.pdb operation_env/SAAMBE-3D-master/
cp benchmark/dataset/VarEPS/mutation_list.txt operation_env/SAAMBE-3D-master/

# Run SAAMBE-3D with regression model (model 1 for ΔΔG prediction)
cd operation_env/SAAMBE-3D-master/
python saambe-3d.py -i 4KMN.pdb -f mutation_list.txt -d 1 -o /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/vareps_annotation/predictions.out
</execute>
<observation>Check outputs in file: '/root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/vareps_annotation/predictions.out'
</observation>
Let's check the prediction results:

<execute>#!BASH
cat /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/vareps_annotation/predictions.out
</execute>
<observation>Structure_file Chain Position Wild Mutant ddG(kcal/mol) Type
4KMN.pdb A 303 C A 0.38 Destabilizing
4KMN.pdb A 304 D A 0.30 Destabilizing
4KMN.pdb A 305 G A 0.09 Destabilizing
4KMN.pdb A 306 G A 0.27 Destabilizing
4KMN.pdb A 307 L A 0.64 Destabilizing
</observation>
Now let's identify the most stable mutation (smallest ΔΔG value) and save it to the required file:

<execute>#!BASH
# Extract the data rows, sort by ΔΔG, get the first one
tail -n +2 /root/autodl-tmp/biomni_v20260208_tmp/doubao-seed-1-8/vareps_annotation/predictions.out | sort -k6,6n | head -1 | awk '{print $2, $3, $4, $5, $6}' > /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt

# Check the result
cat /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt
</execute>
<observation>A 305 G A 0.09
</observation>
Let me create the final output in the exact format requested:

<execute>#!BASH
# Format the output as requested (Chain Position Wild Mutant ΔΔG)
awk '{print $1, $2, $3, $4, $5}' /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt > temp.txt && mv temp.txt /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt

# Verify the final output
cat /root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt
</execute>
<observation>A 305 G A 0.09
</observation>
The most stable mutation has been identified and saved successfully. Here's the final result:

<solution>A 305 G A 0.09</solution>

The result is also saved in `/root/autodl-tmp/biomni_v20260208_pred_results/doubao-seed-1-8/most_stable_mutation.txt`

This mutation (G305A in chain A) has the smallest ΔΔG value of 0.09 kcal/mol, indicating it's the most stable among all tested mutations. Lower ΔΔG values mean less destabilization of the protein-protein complex.