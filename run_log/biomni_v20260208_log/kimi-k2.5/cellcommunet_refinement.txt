Perform quality control on a single-cell RNA-seq dataset. 

Load the raw PBMC3k dataset from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`. 

First, filter out cells that express fewer than 200 genes. 

Second, filter out cells that express more than 2500 genes. 

Third, calculate the percentage of counts from mitochondrial genes for each cell and remove any cell where this percentage exceeds 5%.

Finally, save the filtered data as an AnnData object to `/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5/cellcommunet_refinement.h5ad`.

All intermediate results should be stored in the `/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement` directory.

I'll help you perform quality control on the PBMC3k single-cell RNA-seq dataset. Let me create a detailed plan and execute it step by step.

## Plan

1. [ ] Create necessary directories for intermediate and final results
2. [ ] Load the raw PBMC3k dataset from the specified path
3. [ ] Filter out cells expressing fewer than 200 genes
4. [ ] Filter out cells expressing more than 2500 genes
5. [ ] Calculate mitochondrial gene percentage and remove cells with >5% mitochondrial counts
6. [ ] Save the final filtered AnnData object to the specified path

Let me start by setting up the environment and loading the data:

<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

# Set up directories
tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

os.makedirs(tmp_dir, exist_ok=True)
os.makedirs(result_dir, exist_ok=True)

print("Directories created successfully!")
print(f"Temp directory: {tmp_dir}")
print(f"Result directory: {result_dir}")

# Load the raw PBMC3k dataset
input_path = "benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad"
print(f"\nLoading raw data from: {input_path}")
adata = sc.read_h5ad(input_path)

print(f"\nOriginal dataset shape: {adata.shape}")
print(f"Number of cells: {adata.n_obs}")
print(f"Number of genes: {adata.n_vars}")
</execute>
<observation>Directories created successfully!
Temp directory: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement
Result directory: /root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5

Loading raw data from: benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad

Original dataset shape: (2700, 32738)
Number of cells: 2700
Number of genes: 32738
</observation>
Great! The data is loaded. Now let me proceed with the quality control filtering steps:

<execute>
# Step 1: Check initial cell counts per gene and gene counts per cell
print("=" * 60)
print("INITIAL QC METRICS")
print("=" * 60)

# Calculate initial metrics
adata.obs['n_genes'] = (adata.X > 0).sum(axis=1).A1 if hasattr(adata.X, 'A1') else (adata.X > 0).sum(axis=1)
adata.obs['n_counts'] = adata.X.sum(axis=1).A1 if hasattr(adata.X, 'A1') else adata.X.sum(axis=1)

print(f"\nInitial gene counts per cell:")
print(f"  Min genes per cell: {adata.obs['n_genes'].min()}")
print(f"  Max genes per cell: {adata.obs['n_genes'].max()}")
print(f"  Mean genes per cell: {adata.obs['n_genes'].mean():.2f}")

# Save initial state
adata.obs.to_csv(f"{tmp_dir}/initial_qc_metrics.csv")
print(f"\nInitial QC metrics saved to: {tmp_dir}/initial_qc_metrics.csv")

print(f"\nStarting with {adata.n_obs} cells and {adata.n_vars} genes")
</execute>
<observation>NameError("name 'adata' is not defined")</observation>
Let me reload the data and continue:

<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

# Set up directories
tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

os.makedirs(tmp_dir, exist_ok=True)
os.makedirs(result_dir, exist_ok=True)

# Load the raw PBMC3k dataset
input_path = "benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad"
print(f"Loading raw data from: {input_path}")
adata = sc.read_h5ad(input_path)

print(f"Original dataset shape: {adata.shape}")
print(f"Number of cells: {adata.n_obs}")
print(f"Number of genes: {adata.n_vars}")

# Calculate initial metrics
print("\n" + "=" * 60)
print("INITIAL QC METRICS")
print("=" * 60)

# Calculate n_genes and n_counts
if hasattr(adata.X, 'toarray'):
    adata.obs['n_genes'] = (adata.X > 0).sum(axis=1).A1
    adata.obs['n_counts'] = adata.X.sum(axis=1).A1
else:
    adata.obs['n_genes'] = (adata.X > 0).sum(axis=1)
    adata.obs['n_counts'] = adata.X.sum(axis=1)

print(f"Min genes per cell: {adata.obs['n_genes'].min()}")
print(f"Max genes per cell: {adata.obs['n_genes'].max()}")
print(f"Mean genes per cell: {adata.obs['n_genes'].mean():.2f}")

# Save initial state
adata.obs.to_csv(f"{tmp_dir}/initial_qc_metrics.csv")
print(f"\nInitial QC metrics saved to: {tmp_dir}/initial_qc_metrics.csv")
</execute>
<observation>Loading raw data from: benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad
Original dataset shape: (2700, 32738)
Number of cells: 2700
Number of genes: 32738

============================================================
INITIAL QC METRICS
============================================================
Min genes per cell: 212
Max genes per cell: 3422
Mean genes per cell: 846.99

Initial QC metrics saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/initial_qc_metrics.csv
</observation>
Now let me proceed with the filtering steps:

<execute>
print("\n" + "=" * 60)
print("FILTERING STEP 1: Remove cells with fewer than 200 genes")
print("=" * 60)

# Filter 1: Remove cells with fewer than 200 genes
cells_before = adata.n_obs
sc.pp.filter_cells(adata, min_genes=200)
cells_after_filter1 = adata.n_obs
removed_filter1 = cells_before - cells_after_filter1

print(f"Cells before filter: {cells_before}")
print(f"Cells after filter: {cells_after_filter1}")
print(f"Cells removed: {removed_filter1}")

# Save intermediate result
adata.write(f"{tmp_dir}/after_filter1_min200genes.h5ad")
print(f"Intermediate result saved to: {tmp_dir}/after_filter1_min200genes.h5ad")
</execute>
<observation>NameError("name 'adata' is not defined")</observation>
Let me run all the QC steps in a single continuous code block:

<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

# Set up directories
tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

os.makedirs(tmp_dir, exist_ok=True)
os.makedirs(result_dir, exist_ok=True)

# Load the raw PBMC3k dataset
input_path = "benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad"
print(f"Loading raw data from: {input_path}")
adata = sc.read_h5ad(input_path)

print(f"\nOriginal dataset shape: {adata.shape}")
print(f"Number of cells: {adata.n_obs}")
print(f"Number of genes: {adata.n_vars}")

# Calculate initial metrics
print("\n" + "=" * 60)
print("INITIAL QC METRICS")
print("=" * 60)

# Calculate n_genes and n_counts
adata.obs['n_genes'] = np.array((adata.X > 0).sum(axis=1)).flatten()
adata.obs['n_counts'] = np.array(adata.X.sum(axis=1)).flatten()

print(f"Min genes per cell: {adata.obs['n_genes'].min()}")
print(f"Max genes per cell: {adata.obs['n_genes'].max()}")
print(f"Mean genes per cell: {adata.obs['n_genes'].mean():.2f}")

# Save initial state
adata.obs.to_csv(f"{tmp_dir}/initial_qc_metrics.csv")
print(f"\nInitial QC metrics saved to: {tmp_dir}/initial_qc_metrics.csv")

print("\n" + "=" * 60)
print("FILTERING STEP 1: Remove cells with fewer than 200 genes")
print("=" * 60)

# Filter 1: Remove cells with fewer than 200 genes
cells_before = adata.n_obs
sc.pp.filter_cells(adata, min_genes=200)
cells_after_filter1 = adata.n_obs
removed_filter1 = cells_before - cells_after_filter1

print(f"Cells before filter: {cells_before}")
print(f"Cells after filter: {cells_after_filter1}")
print(f"Cells removed: {removed_filter1}")

# Save intermediate result
adata.write(f"{tmp_dir}/after_filter1_min200genes.h5ad")
print(f"Intermediate result saved to: {tmp_dir}/after_filter1_min200genes.h5ad")
</execute>
<observation>Loading raw data from: benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad

Original dataset shape: (2700, 32738)
Number of cells: 2700
Number of genes: 32738

============================================================
INITIAL QC METRICS
============================================================
Min genes per cell: 212
Max genes per cell: 3422
Mean genes per cell: 846.99

Initial QC metrics saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/initial_qc_metrics.csv

============================================================
FILTERING STEP 1: Remove cells with fewer than 200 genes
============================================================
Cells before filter: 2700
Cells after filter: 2700
Cells removed: 0
Intermediate result saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/after_filter1_min200genes.h5ad
</observation>
Excellent! Filter 1 passed with no cells removed (all cells had ≥200 genes). Now let me continue with the remaining filtering steps:

<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

# Reload from intermediate result
adata = sc.read_h5ad(f"{tmp_dir}/after_filter1_min200genes.h5ad")

print("=" * 60)
print("FILTERING STEP 2: Remove cells with more than 2500 genes")
print("=" * 60)

# Filter 2: Remove cells with more than 2500 genes
cells_before = adata.n_obs
sc.pp.filter_cells(adata, max_genes=2500)
cells_after_filter2 = adata.n_obs
removed_filter2 = cells_before - cells_after_filter2

print(f"Cells before filter: {cells_before}")
print(f"Cells after filter: {cells_after_filter2}")
print(f"Cells removed: {removed_filter2}")

# Save intermediate result
adata.write(f"{tmp_dir}/after_filter2_max2500genes.h5ad")
print(f"Intermediate result saved to: {tmp_dir}/after_filter2_max2500genes.h5ad")

# Also save filtering statistics
filter_stats = {
    'filter': ['min_genes_200', 'max_genes_2500'],
    'cells_removed': [0, removed_filter2],
    'cells_remaining': [cells_after_filter1, cells_after_filter2]
}
pd.DataFrame(filter_stats).to_csv(f"{tmp_dir}/filtering_statistics.csv", index=False)
</execute>
<observation>NameError("name 'cells_after_filter1' is not defined")</observation>
<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

# Reload from intermediate result
adata = sc.read_h5ad(f"{tmp_dir}/after_filter1_min200genes.h5ad")

print("=" * 60)
print("FILTERING STEP 2: Remove cells with more than 2500 genes")
print("=" * 60)

# Filter 2: Remove cells with more than 2500 genes
cells_before = adata.n_obs
sc.pp.filter_cells(adata, max_genes=2500)
cells_after_filter2 = adata.n_obs
removed_filter2 = cells_before - cells_after_filter2

print(f"Cells before filter: {cells_before}")
print(f"Cells after filter: {cells_after_filter2}")
print(f"Cells removed: {removed_filter2}")

# Save intermediate result
adata.write(f"{tmp_dir}/after_filter2_max2500genes.h5ad")
print(f"Intermediate result saved to: {tmp_dir}/after_filter2_max2500genes.h5ad")

# Save filtering statistics
filter_stats = {
    'filter': ['min_genes_200', 'max_genes_2500'],
    'cells_removed': [0, removed_filter2],
    'cells_remaining': [2700, cells_after_filter2]
}
pd.DataFrame(filter_stats).to_csv(f"{tmp_dir}/filtering_statistics.csv", index=False)
print(f"Filtering statistics saved to: {tmp_dir}/filtering_statistics.csv")
</execute>
<observation>============================================================
FILTERING STEP 2: Remove cells with more than 2500 genes
============================================================
Cells before filter: 2700
Cells after filter: 2695
Cells removed: 5
Intermediate result saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/after_filter2_max2500genes.h5ad
Filtering statistics saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/filtering_statistics.csv
</observation>
Now let me proceed with the mitochondrial gene filtering (Step 3):

<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

# Reload from intermediate result
adata = sc.read_h5ad(f"{tmp_dir}/after_filter2_max2500genes.h5ad")

print("=" * 60)
print("FILTERING STEP 3: Mitochondrial gene percentage filtering")
print("=" * 60)

# Calculate mitochondrial gene percentage
# Mitochondrial genes start with 'MT-' in human datasets
adata.var['mt'] = adata.var_names.str.startswith('MT-')
print(f"Number of mitochondrial genes found: {adata.var['mt'].sum()}")

# Calculate percentage of mitochondrial counts
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)

print(f"\nMitochondrial percentage statistics:")
print(f"  Min: {adata.obs['pct_counts_mt'].min():.2f}%")
print(f"  Max: {adata.obs['pct_counts_mt'].max():.2f}%")
print(f"  Mean: {adata.obs['pct_counts_mt'].mean():.2f}%")
print(f"  Median: {adata.obs['pct_counts_mt'].median():.2f}%")

# Count cells that would be removed (>5% mitochondrial)
cells_high_mt = (adata.obs['pct_counts_mt'] > 5).sum()
print(f"\nCells with >5% mitochondrial counts: {cells_high_mt}")

# Save QC metrics before filtering
adata.obs.to_csv(f"{tmp_dir}/before_mt_filter_qc_metrics.csv")
print(f"\nQC metrics before MT filter saved to: {tmp_dir}/before_mt_filter_qc_metrics.csv")

# Filter 3: Remove cells with >5% mitochondrial counts
cells_before = adata.n_obs
adata = adata[adata.obs['pct_counts_mt'] < 5, :].copy()
cells_after_filter3 = adata.n_obs
removed_filter3 = cells_before - cells_after_filter3

print(f"\nCells before MT filter: {cells_before}")
print(f"Cells after MT filter: {cells_after_filter3}")
print(f"Cells removed by MT filter: {removed_filter3}")

# Save intermediate result
adata.write(f"{tmp_dir}/after_filter3_mt5pct.h5ad")
print(f"Intermediate result saved to: {tmp_dir}/after_filter3_mt5pct.h5ad")
</execute>
<observation>============================================================
FILTERING STEP 3: Mitochondrial gene percentage filtering
============================================================
Number of mitochondrial genes found: 13

Mitochondrial percentage statistics:
  Min: 0.00%
  Max: 22.57%
  Mean: 2.22%
  Median: 2.03%

Cells with >5% mitochondrial counts: 57

QC metrics before MT filter saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/before_mt_filter_qc_metrics.csv

Cells before MT filter: 2695
Cells after MT filter: 2638
Cells removed by MT filter: 57
Intermediate result saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/after_filter3_mt5pct.h5ad
</observation>
Now let me save the final filtered data and create a summary report:

<execute>
import os
import numpy as np
import pandas as pd
import scanpy as sc
import anndata

tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement"
result_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5"

# Reload from intermediate result
adata = sc.read_h5ad(f"{tmp_dir}/after_filter3_mt5pct.h5ad")

print("=" * 60)
print("FINAL SUMMARY AND SAVING RESULTS")
print("=" * 60)

# Final QC metrics
print(f"\nFinal filtered dataset:")
print(f"  Shape: {adata.shape}")
print(f"  Number of cells: {adata.n_obs}")
print(f"  Number of genes: {adata.n_vars}")

# Recalculate final metrics
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
print(f"\nFinal QC metrics:")
print(f"  Min genes per cell: {adata.obs['n_genes_by_counts'].min()}")
print(f"  Max genes per cell: {adata.obs['n_genes_by_counts'].max()}")
print(f"  Mean genes per cell: {adata.obs['n_genes_by_counts'].mean():.2f}")
print(f"  Mean mitochondrial %: {adata.obs['pct_counts_mt'].mean():.2f}%")

# Create comprehensive summary
summary = {
    'step': ['Original', 'After filter 1 (min 200 genes)', 'After filter 2 (max 2500 genes)', 'After filter 3 (MT < 5%)'],
    'cells': [2700, 2700, 2695, 2638],
    'cells_removed': [0, 0, 5, 57],
    'genes': [32738, 32738, 32738, 32738]
}
summary_df = pd.DataFrame(summary)
print("\n" + "=" * 60)
print("QC FILTERING SUMMARY")
print("=" * 60)
print(summary_df.to_string(index=False))

summary_df.to_csv(f"{tmp_dir}/final_qc_summary.csv", index=False)
print(f"\nSummary saved to: {tmp_dir}/final_qc_summary.csv")

# Save final filtered data
output_path = f"{result_dir}/cellcommunet_refinement.h5ad"
adata.write(output_path)
print(f"\n✓ Final filtered AnnData saved to: {output_path}")

# Save final QC metrics
adata.obs.to_csv(f"{tmp_dir}/final_qc_metrics.csv")
print(f"✓ Final QC metrics saved to: {tmp_dir}/final_qc_metrics.csv")

print("\n" + "=" * 60)
print("QC PIPELINE COMPLETED SUCCESSFULLY!")
print("=" * 60)
print(f"Total cells removed: {2700 - 2638} ({(2700 - 2638) / 2700 * 100:.2f}%)")
print(f"Final dataset: {adata.n_obs} cells × {adata.n_vars} genes")
</execute>
<observation>============================================================
FINAL SUMMARY AND SAVING RESULTS
============================================================

Final filtered dataset:
  Shape: (2638, 32738)
  Number of cells: 2638
  Number of genes: 32738

Final QC metrics:
  Min genes per cell: 212
  Max genes per cell: 2455
  Mean genes per cell: 850.09
  Mean mitochondrial %: 2.12%

============================================================
QC FILTERING SUMMARY
============================================================
                           step  cells  cells_removed  genes
                       Original   2700              0  32738
 After filter 1 (min 200 genes)   2700              0  32738
After filter 2 (max 2500 genes)   2695              5  32738
       After filter 3 (MT < 5%)   2638             57  32738

Summary saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/final_qc_summary.csv

✓ Final filtered AnnData saved to: /root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5/cellcommunet_refinement.h5ad
✓ Final QC metrics saved to: /root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/final_qc_metrics.csv

============================================================
QC PIPELINE COMPLETED SUCCESSFULLY!
============================================================
Total cells removed: 62 (2.30%)
Final dataset: 2638 cells × 32738 genes
</observation>
Let me update the plan to show all completed steps:

## Updated Plan

1. [✓] Create necessary directories for intermediate and final results
2. [✓] Load the raw PBMC3k dataset from the specified path
3. [✓] Filter out cells expressing fewer than 200 genes (0 cells removed - all cells already had ≥200 genes)
4. [✓] Filter out cells expressing more than 2500 genes (5 cells removed)
5. [✓] Calculate mitochondrial gene percentage and remove cells with >5% mitochondrial counts (57 cells removed)
6. [✓] Save the final filtered AnnData object to the specified path

All steps completed successfully! Let me verify the final output:

<execute>
import scanpy as sc

# Verify the final saved file
output_path = "/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5/cellcommunet_refinement.h5ad"
adata_final = sc.read_h5ad(output_path)

print("=" * 60)
print("VERIFICATION OF FINAL OUTPUT")
print("=" * 60)
print(f"File exists and loaded successfully: {output_path}")
print(f"Shape: {adata_final.shape}")
print(f"Number of cells: {adata_final.n_obs}")
print(f"Number of genes: {adata_final.n_vars}")
print(f"\nQC metrics in .obs columns: {list(adata_final.obs.columns)}")
print(f"\nVerification complete - QC pipeline successful!")
</execute>
<observation>============================================================
VERIFICATION OF FINAL OUTPUT
============================================================
File exists and loaded successfully: /root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5/cellcommunet_refinement.h5ad
Shape: (2638, 32738)
Number of cells: 2638
Number of genes: 32738

QC metrics in .obs columns: ['n_genes', 'n_counts', 'n_genes_by_counts', 'total_counts', 'total_counts_mt', 'pct_counts_mt']

Verification complete - QC pipeline successful!
</observation>
<solution>

## Quality Control Pipeline Completed Successfully

I have performed quality control on the PBMC3k single-cell RNA-seq dataset following all specified steps:

### Summary of Results

| Step | Description | Cells Removed | Cells Remaining |
|------|-------------|---------------|-----------------|
| Original | Raw dataset | - | 2,700 |
| Filter 1 | Min 200 genes/cell | 0 | 2,700 |
| Filter 2 | Max 2500 genes/cell | 5 | 2,695 |
| Filter 3 | MT genes < 5% | 57 | 2,638 |

### Final Statistics
- **Total cells removed**: 62 (2.30%)
- **Final dataset**: 2,638 cells × 32,738 genes
- **Final QC metrics**: Mean genes per cell = 850.09, Mean MT% = 2.12%

### Output Files

**Final Result:**
- `/root/autodl-tmp/biomni_v20260208_pred_results/kimi-k2.5/cellcommunet_refinement.h5ad`

**Intermediate Files (in `/root/autodl-tmp/biomni_v20260208_tmp/kimi-k2.5/cellcommunet_refinement/`):**
- `initial_qc_metrics.csv` - Initial QC metrics
- `after_filter1_min200genes.h5ad` - After filter 1
- `after_filter2_max2500genes.h5ad` - After filter 2
- `before_mt_filter_qc_metrics.csv` - QC before MT filter
- `after_filter3_mt5pct.h5ad` - After filter 3
- `final_qc_summary.csv` - Complete filtering summary
- `final_qc_metrics.csv` - Final QC metrics

All QC criteria were successfully applied and the filtered AnnData object has been saved to the specified location.

</solution>