Perform quality control on a single-cell RNA-seq dataset. 

Load the raw PBMC3k dataset from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`. 

First, filter out cells that express fewer than 200 genes. 

Second, filter out cells that express more than 2500 genes. 

Third, calculate the percentage of counts from mitochondrial genes for each cell and remove any cell where this percentage exceeds 5%.

Finally, save the filtered data as an AnnData object to `/root/autodl-tmp/biomni_v20260208_pred_results/qwen3-max-2026-01-23/cellcommunet_refinement.h5ad`.

All intermediate results should be stored in the `/root/autodl-tmp/biomni_v20260208_tmp/qwen3-max-2026-01-23/cellcommunet_refinement` directory.

1. [ ] Load the raw PBMC3k dataset from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`.
2. [ ] Filter out cells that express fewer than 200 genes.
3. [ ] Filter out cells that express more than 2500 genes.
4. [ ] Calculate the percentage of counts from mitochondrial genes for each cell and remove any cell where this percentage exceeds 5%.
5. [ ] Save the filtered data as an AnnData object to `/root/autodl-tmp/biomni_v20260208_pred_results/qwen3-max-2026-01-23/cellcommunet_refinement.h5ad`.
6. [ ] Ensure all intermediate results are stored in the `/root/autodl-tmp/biomni_v20260208_tmp/qwen3-max-2026-01-23/cellcommunet_refinement` directory.

<execute>
import scanpy as sc
import os

# Define paths
input_path = "benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad"
output_dir = "/root/autodl-tmp/biomni_v20260208_tmp/qwen3-max-2026-01-23/cellcommunet_refinement"
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/qwen3-max-2026-01-23/cellcommunet_refinement.h5ad"

# Create output directory if it doesn't exist
os.makedirs(output_dir, exist_ok=True)

# Step 1: Load the raw PBMC3k dataset
adata = sc.read(input_path)
print(f"Loaded dataset with {adata.n_obs} cells and {adata.n_vars} genes.")

# Save initial state
adata.write(os.path.join(output_dir, "initial.h5ad"))

# Step 2: Filter out cells that express fewer than 200 genes
sc.pp.filter_cells(adata, min_genes=200)
print(f"After filtering cells with <200 genes: {adata.n_obs} cells remain.")

# Save after first filter
adata.write(os.path.join(output_dir, "after_min_genes_filter.h5ad"))

# Step 3: Filter out cells that express more than 2500 genes
sc.pp.filter_cells(adata, max_genes=2500)
print(f"After filtering cells with >2500 genes: {adata.n_obs} cells remain.")

# Save after second filter
adata.write(os.path.join(output_dir, "after_max_genes_filter.h5ad"))

# Step 4: Calculate mitochondrial gene percentage and filter
adata.var['mt'] = adata.var_names.str.startswith('MT-')  # annotate mitochondrial genes
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)
adata = adata[adata.obs.pct_counts_mt < 5, :]
print(f"After filtering cells with >5% mitochondrial counts: {adata.n_obs} cells remain.")

# Save after mitochondrial filter
adata.write(os.path.join(output_dir, "after_mitochondrial_filter.h5ad"))

# Step 5: Save final filtered data
os.makedirs(os.path.dirname(output_file), exist_ok=True)
adata.write(output_file)
print(f"Final filtered data saved to {output_file}")
</execute>
<observation>Loaded dataset with 2700 cells and 32738 genes.
After filtering cells with <200 genes: 2700 cells remain.
After filtering cells with >2500 genes: 2695 cells remain.
After filtering cells with >5% mitochondrial counts: 2638 cells remain.
Final filtered data saved to /root/autodl-tmp/biomni_v20260208_pred_results/qwen3-max-2026-01-23/cellcommunet_refinement.h5ad
</observation>
1. [✓] Load the raw PBMC3k dataset from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`.
2. [✓] Filter out cells that express fewer than 200 genes.
3. [✓] Filter out cells that express more than 2500 genes.
4. [✓] Calculate the percentage of counts from mitochondrial genes for each cell and remove any cell where this percentage exceeds 5%.
5. [✓] Save the filtered data as an AnnData object to `/root/autodl-tmp/biomni_v20260208_pred_results/qwen3-max-2026-01-23/cellcommunet_refinement.h5ad`.
6. [✓] Ensure all intermediate results are stored in the `/root/autodl-tmp/biomni_v20260208_tmp/qwen3-max-2026-01-23/cellcommunet_refinement` directory.

The quality control process has been successfully completed. The final filtered dataset containing 2638 cells has been saved to the specified output path, and all intermediate results have been stored in the designated temporary directory. 

<solution>Quality control completed successfully. Final dataset with 2638 cells saved to /root/autodl-tmp/biomni_v20260208_pred_results/qwen3-max-2026-01-23/cellcommunet_refinement.h5ad</solution>