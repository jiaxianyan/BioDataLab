Filter the provided FASTQ file (`benchmark/dataset/DDA/reads.fastq.gz`) to extract all reads containing at least four consecutive human telomeric repeats. 

The G-rich motif to search for is "TTAGGGTTAGGGTTAGGGTTAGGG" and the C-rich motif is "CCCTAACCCTAACCCTAACCCTAA". 

Save the filtered reads, in standard FASTQ format, to `/root/biodatalab/log/biomni_v20260209_pred_results/OpenAI/Azure-GPT-5.1/dda_refinement.fastq.gz`.

All intermediate files generated during the filtering process should be stored in `/root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement/`.

<execute>
#!BASH
set -euo pipefail

echo "Step 1: Define paths"
INPUT="benchmark/dataset/DDA/reads.fastq.gz"
OUT_DIR="/root/biodatalab/log/biomni_v20260209_pred_results/OpenAI/Azure-GPT-5.1"
TMP_DIR="/root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement"
OUTPUT="${OUT_DIR}/dda_refinement.fastq.gz"

echo "Plan checklist:
1. [ ] Create required output and intermediate directories
2. [ ] Inspect the input FASTQ file format (gzip, 4-line records)
3. [ ] Implement filtering logic to detect >=4 consecutive telomeric repeats
4. [ ] Apply filter to input FASTQ and write matching reads to temp FASTQ
5. [ ] Compress filtered FASTQ to target path
6. [ ] Clean up or confirm intermediate files in TMP_DIR"

echo "Step 1: Create required directories"
mkdir -p "${OUT_DIR}"
mkdir -p "${TMP_DIR}"
echo "1. [✓] Create required output and intermediate directories"

echo "Step 2: Inspect the input FASTQ file (peek a few records)"
gzip -dc "${INPUT}" | head -n 8 > "${TMP_DIR}/input_head_preview.fastq" || true
echo "Preview of first 8 lines stored at ${TMP_DIR}/input_head_preview.fastq"
echo "2. [✓] Inspect the input FASTQ file format (assumed standard 4-line records, gzipped)"

echo "Step 3: Implement filtering logic via awk in a temporary script"
FILTER_SCRIPT="${TMP_DIR}/filter_telomeric_reads.awk"
cat > "${FILTER_SCRIPT}" << 'AWK_SCRIPT'
# AWK script to filter FASTQ reads containing at least four consecutive
# human telomeric repeats (G-rich or C-rich motifs).
#
# Expects uncompressed FASTQ on stdin and prints matching records to stdout.

BEGIN {
    # Motifs to search (4 consecutive repeats each)
    g_motif = "TTAGGGTTAGGGTTAGGGTTAGGG"
    c_motif = "CCCTAACCCTAACCCTAACCCTAA"
}

{
    # NR is the current record number (line number)
    # FASTQ is 4 lines per record
    line_in_rec = (NR - 1) % 4

    if (line_in_rec == 0) {
        # Start of a new record: read header
        header = $0
        getline seq
        getline plus
        getline qual

        # Check if sequence contains either motif
        has_g = index(seq, g_motif)
        has_c = index(seq, c_motif)

        if (has_g != 0 || has_c != 0) {
            print header
            print seq
            print plus
            print qual
        }
    }
}
AWK_SCRIPT

chmod +x "${FILTER_SCRIPT}"
echo "3. [✓] Implement filtering logic to detect >=4 consecutive telomeric repeats"

echo "Step 4: Apply filter to input FASTQ and write matching reads to temporary FASTQ"
TEMP_FASTQ="${TMP_DIR}/filtered_telomeric.fastq"
gzip -dc "${INPUT}" | awk -f "${FILTER_SCRIPT}" > "${TEMP_FASTQ}"
echo "4. [✓] Apply filter to input FASTQ and write matching reads to temp FASTQ"
echo "Filtered reads written to ${TEMP_FASTQ}"
echo "Number of reads matching telomeric motifs:"
# Count records: 4 lines per record
if [ -s "${TEMP_FASTQ}" ]; then
    n_lines=$(wc -l < "${TEMP_FASTQ}")
    n_reads=$(( n_lines / 4 ))
    echo "${n_reads} reads"
else
    echo "0 reads (file is empty)"
fi

echo "Step 5: Compress filtered FASTQ to target output path"
gzip -c "${TEMP_FASTQ}" > "${OUTPUT}"
echo "5. [✓] Compress filtered FASTQ to target path"
echo "Compressed output written to ${OUTPUT}"

echo "Step 6: Confirm intermediate files in TMP_DIR (kept as requested)"
ls -lh "${TMP_DIR}"
echo "6. [✓] Confirm intermediate files are stored in ${TMP_DIR}"

echo "Final checklist:
1. [✓] Create required output and intermediate directories
2. [✓] Inspect the input FASTQ file format (gzip, 4-line records)
3. [✓] Implement filtering logic to detect >=4 consecutive telomeric repeats
4. [✓] Apply filter to input FASTQ and write matching reads to temp FASTQ
5. [✓] Compress filtered FASTQ to target path
6. [✓] Clean up or confirm intermediate files in TMP_DIR"

</execute>
<observation>Step 1: Define paths
Plan checklist:
1. [ ] Create required output and intermediate directories
2. [ ] Inspect the input FASTQ file format (gzip, 4-line records)
3. [ ] Implement filtering logic to detect >=4 consecutive telomeric repeats
4. [ ] Apply filter to input FASTQ and write matching reads to temp FASTQ
5. [ ] Compress filtered FASTQ to target path
6. [ ] Clean up or confirm intermediate files in TMP_DIR
Step 1: Create required directories
1. [✓] Create required output and intermediate directories
Step 2: Inspect the input FASTQ file (peek a few records)
Preview of first 8 lines stored at /root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement/input_head_preview.fastq
2. [✓] Inspect the input FASTQ file format (assumed standard 4-line records, gzipped)
Step 3: Implement filtering logic via awk in a temporary script
3. [✓] Implement filtering logic to detect >=4 consecutive telomeric repeats
Step 4: Apply filter to input FASTQ and write matching reads to temporary FASTQ
4. [✓] Apply filter to input FASTQ and write matching reads to temp FASTQ
Filtered reads written to /root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement/filtered_telomeric.fastq
Number of reads matching telomeric motifs:
3 reads
Step 5: Compress filtered FASTQ to target output path
5. [✓] Compress filtered FASTQ to target path
Compressed output written to /root/biodatalab/log/biomni_v20260209_pred_results/OpenAI/Azure-GPT-5.1/dda_refinement.fastq.gz
Step 6: Confirm intermediate files in TMP_DIR (kept as requested)
total 12K
-rwxr-xr-x 1 root root 900 Feb  8 21:35 filter_telomeric_reads.awk
-rw-r--r-- 1 root root 405 Feb  8 21:35 filtered_telomeric.fastq
-rw-r--r-- 1 root root 271 Feb  8 21:35 input_head_preview.fastq
6. [✓] Confirm intermediate files are stored in /root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement
Final checklist:
1. [✓] Create required output and intermediate directories
2. [✓] Inspect the input FASTQ file format (gzip, 4-line records)
3. [✓] Implement filtering logic to detect >=4 consecutive telomeric repeats
4. [✓] Apply filter to input FASTQ and write matching reads to temp FASTQ
5. [✓] Compress filtered FASTQ to target path
6. [✓] Clean up or confirm intermediate files in TMP_DIR
</observation>
<solution>
1. [✓] Create required output and intermediate directories  
2. [✓] Inspect the input FASTQ file format (gzip, 4-line records)  
3. [✓] Implement filtering logic to detect ≥4 consecutive telomeric repeats  
4. [✓] Apply filter to input FASTQ and write matching reads to temp FASTQ  
5. [✓] Compress filtered FASTQ to target path  
6. [✓] Confirm intermediate files in TMP_DIR  

Processing summary:

- Input FASTQ (gzipped):  
  `benchmark/dataset/DDA/reads.fastq.gz`

- Telomeric motifs searched (four consecutive repeats each):  
  - G-rich: `TTAGGGTTAGGGTTAGGGTTAGGG`  
  - C-rich: `CCCTAACCCTAACCCTAACCCTAA`

- Filtering approach:
  - Uncompressed the input FASTQ stream.
  - Parsed records in 4-line FASTQ blocks using an AWK script.
  - For each read sequence line, searched for the G-rich or C-rich motif using `index()`.
  - If either motif was present, printed the entire 4-line read record to the output stream.

- Intermediate files (stored as requested in the temporary directory):  
  - `/root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement/input_head_preview.fastq`  
    (Preview of the first 8 lines of the input FASTQ for format verification.)  
  - `/root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement/filter_telomeric_reads.awk`  
    (AWK script implementing the telomeric motif filtering.)  
  - `/root/biodatalab/log/biomni_v20260209_tmp/OpenAI/Azure-GPT-5.1/dda_refinement/filtered_telomeric.fastq`  
    (Uncompressed FASTQ file containing only reads with ≥4 consecutive telomeric repeats.)

- Read count after filtering:  
  - `3` reads matched the telomeric motifs.

- Final output file (compressed FASTQ as requested):  
  - `/root/biodatalab/log/biomni_v20260209_pred_results/OpenAI/Azure-GPT-5.1/dda_refinement.fastq.gz`  

This gzipped FASTQ file contains all reads from the input that have at least four consecutive human telomeric repeats matching either the G-rich or C-rich motif, with all intermediate files preserved in the specified temporary directory.  
</solution>