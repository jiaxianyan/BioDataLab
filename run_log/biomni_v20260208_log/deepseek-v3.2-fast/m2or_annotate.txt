Given a FASTA file `benchmark/dataset/M2OR/mutant_M2OR.fasta` containing a mutated sequence of the human Muscarinic Acetylcholine Receptor M2. 

Identify the single point mutation by comparing it against the canonical wild-type sequence (UniProt accession: P08172). 

Saving the result to `/root/autodl-tmp/biomni_v20260208_pred_results/deepseek-v3.2-fast/m2or_annotate.json` with `wild_type_sequence` key and `mutation`.

Output example (for reference):
{
  "wild_type_sequence": "FAFGSFAFGSFAFGSFAFGSFAFGSFAFGSFAFGSFAFGSFAFGSFAFGSFAFGS",
  "A100G"
}

All intermediate results should be saved to `/root/autodl-tmp/biomni_v20260208_tmp/deepseek-v3.2-fast/m2or_annotate`

I'll start by making a plan to solve this task.

**Plan:**
1. [ ] Locate the FASTA file and examine its content.
2. [ ] Retrieve the canonical wild-type sequence from UniProt accession P08172.
3. [ ] Align the mutant sequence with the wild-type sequence to identify the single point mutation.
4. [ ] Extract the mutation in the format like "A100G" (wild-type residue, position, mutant residue).
5. [ ] Save the result to the specified JSON file with both wild_type_sequence and mutation keys.
6. [ ] Ensure intermediate results are saved to the specified temporary directory.

Let's start with step 1.

<execute>
import os
from pathlib import Path

# Define paths
fasta_path = "benchmark/dataset/M2OR/mutant_M2OR.fasta"
output_json = "/root/autodl-tmp/biomni_v20260208_pred_results/deepseek-v3.2-fast/m2or_annotate.json"
tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/deepseek-v3.2-fast/m2or_annotate"

# Create temporary directory if it doesn't exist
os.makedirs(tmp_dir, exist_ok=True)
os.makedirs(os.path.dirname(output_json), exist_ok=True)

# Check if FASTA file exists
if not os.path.exists(fasta_path):
    print(f"FASTA file not found at {fasta_path}")
else:
    print(f"FASTA file found at {fasta_path}")
    # Read the FASTA file
    with open(fasta_path, 'r') as f:
        content = f.read()
    print("First 200 characters of FASTA file:")
    print(content[:200])
</execute>
<observation>FASTA file found at benchmark/dataset/M2OR/mutant_M2OR.fasta
First 200 characters of FASTA file:
>sp|P08172|CHRM2_HUMAN_mutant
MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWGALDYVVSNASVMNLLIISFDRYFCVTKPLTYPVKRTTKMAGMMIAAAWVLSFILWAPAILFWQFIVGVRT
</observation>
Good. The FASTA file contains a mutant sequence with header "sp|P08172|CHRM2_HUMAN_mutant". Now step 2: retrieve the canonical wild-type sequence from UniProt accession P08172. We can use Biopython's `Bio.Entrez` or `ExPASy` to fetch the sequence. Let's try using `ExPASy.get_sprot_raw`.

<execute>
from Bio import ExPASy
from Bio import SeqIO
import io

# Fetch wild-type sequence from UniProt
accession = "P08172"
try:
    handle = ExPASy.get_sprot_raw(accession)
    record = SeqIO.read(handle, "swiss")
    handle.close()
    wild_type_seq = str(record.seq)
    print(f"Successfully retrieved wild-type sequence for {accession}")
    print(f"Length: {len(wild_type_seq)}")
    print(f"First 100 residues: {wild_type_seq[:100]}")
except Exception as e:
    print(f"Error fetching from ExPASy: {e}")
    # Fallback: maybe we have a local copy? Let's check the data lake.
    # We'll also try using NCBI datasets CLI if available.
    wild_type_seq = None
</execute>
<observation>Successfully retrieved wild-type sequence for P08172
Length: 466
First 100 residues: MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWL
</observation>
Great. Now we have the wild-type sequence. Step 3: align the mutant sequence with the wild-type sequence to identify the single point mutation. First, let's read the mutant sequence from the FASTA file.

<execute>
from Bio import SeqIO

# Read mutant sequence
mutant_record = list(SeqIO.parse(fasta_path, "fasta"))[0]
mutant_seq = str(mutant_record.seq)
print(f"Mutant sequence length: {len(mutant_seq)}")
print(f"First 100 residues: {mutant_seq[:100]}")
print(f"Wild-type sequence length: {len(wild_type_seq)}")
print(f"First 100 residues: {wild_type_seq[:100]}")
</execute>
<observation>NameError("name 'fasta_path' is not defined")</observation>
Oops, I need to re-define the variable. Let's fix that.

<execute>
fasta_path = "benchmark/dataset/M2OR/mutant_M2OR.fasta"
mutant_record = list(SeqIO.parse(fasta_path, "fasta"))[0]
mutant_seq = str(mutant_record.seq)
print(f"Mutant sequence length: {len(mutant_seq)}")
print(f"First 100 residues: {mutant_seq[:100]}")
print(f"Wild-type sequence length: {len(wild_type_seq)}")
print(f"First 100 residues: {wild_type_seq[:100]}")
</execute>
<observation>NameError("name 'SeqIO' is not defined")</observation>
I need to import SeqIO again. Let's do it properly.

<execute>
from Bio import SeqIO

fasta_path = "benchmark/dataset/M2OR/mutant_M2OR.fasta"
mutant_record = list(SeqIO.parse(fasta_path, "fasta"))[0]
mutant_seq = str(mutant_record.seq)
print(f"Mutant sequence length: {len(mutant_seq)}")
print(f"First 100 residues: {mutant_seq[:100]}")
print(f"Wild-type sequence length: {len(wild_type_seq)}")
print(f"First 100 residues: {wild_type_seq[:100]}")
</execute>
<observation>NameError("name 'wild_type_seq' is not defined")</observation>
I need to re-run the previous steps in a single block to ensure all variables are defined.

<execute>
import os
from Bio import ExPASy
from Bio import SeqIO

# Step 1: Read mutant sequence
fasta_path = "benchmark/dataset/M2OR/mutant_M2OR.fasta"
mutant_record = list(SeqIO.parse(fasta_path, "fasta"))[0]
mutant_seq = str(mutant_record.seq)
print(f"Mutant sequence length: {len(mutant_seq)}")
print(f"First 100 residues: {mutant_seq[:100]}")

# Step 2: Fetch wild-type sequence
accession = "P08172"
try:
    handle = ExPASy.get_sprot_raw(accession)
    record = SeqIO.read(handle, "swiss")
    handle.close()
    wild_type_seq = str(record.seq)
    print(f"Wild-type sequence length: {len(wild_type_seq)}")
    print(f"First 100 residues: {wild_type_seq[:100]}")
except Exception as e:
    print(f"Error fetching from ExPASy: {e}")
    wild_type_seq = None
</execute>
<observation>Mutant sequence length: 466
First 100 residues: MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWG
Wild-type sequence length: 466
First 100 residues: MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWL
</observation>
Interesting! The sequences are identical in length (466). Looking at the first 100 residues, they differ at position 100? Let's compare: 

Mutant: ...PVVCDLWG...
Wild-type: ...PVVCDLWL...

So at position 100 (if we count from 1), wild-type has 'L' (Leucine) and mutant has 'G' (Glycine). But we need to verify the exact position. Let's align the sequences to find the exact difference. Since they are the same length, we can do a simple pairwise comparison.

<execute>
# Simple pairwise comparison
differences = []
for i, (wt, mt) in enumerate(zip(wild_type_seq, mutant_seq)):
    if wt != mt:
        differences.append((i+1, wt, mt))  # 1-indexed position

print(f"Number of differences: {len(differences)}")
if differences:
    print("Differences found:")
    for pos, wt, mt in differences:
        print(f"Position {pos}: wild-type '{wt}' -> mutant '{mt}'")
else:
    print("Sequences are identical.")
</execute>
<observation>NameError("name 'wild_type_seq' is not defined")</observation>
Again, I need to ensure variables are defined in the same block. Let's combine everything.

<execute>
import os
from Bio import ExPASy
from Bio import SeqIO

# Step 1: Read mutant sequence
fasta_path = "benchmark/dataset/M2OR/mutant_M2OR.fasta"
mutant_record = list(SeqIO.parse(fasta_path, "fasta"))[0]
mutant_seq = str(mutant_record.seq)
print(f"Mutant sequence length: {len(mutant_seq)}")
print(f"First 100 residues: {mutant_seq[:100]}")

# Step 2: Fetch wild-type sequence
accession = "P08172"
try:
    handle = ExPASy.get_sprot_raw(accession)
    record = SeqIO.read(handle, "swiss")
    handle.close()
    wild_type_seq = str(record.seq)
    print(f"Wild-type sequence length: {len(wild_type_seq)}")
    print(f"First 100 residues: {wild_type_seq[:100]}")
except Exception as e:
    print(f"Error fetching from ExPASy: {e}")
    wild_type_seq = None

# Step 3: Compare sequences
if wild_type_seq:
    differences = []
    for i, (wt, mt) in enumerate(zip(wild_type_seq, mutant_seq)):
        if wt != mt:
            differences.append((i+1, wt, mt))  # 1-indexed position

    print(f"Number of differences: {len(differences)}")
    if differences:
        print("Differences found:")
        for pos, wt, mt in differences:
            print(f"Position {pos}: wild-type '{wt}' -> mutant '{mt}'")
    else:
        print("Sequences are identical.")
</execute>
<observation>Mutant sequence length: 466
First 100 residues: MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWG
Wild-type sequence length: 466
First 100 residues: MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWL
Number of differences: 1
Differences found:
Position 100: wild-type 'L' -> mutant 'G'
</observation>
Perfect! We have identified a single point mutation at position 100: L (Leucine) to G (Glycine). So the mutation is "L100G". However, the output example shows "A100G". That's just an example; we need to output the actual mutation.

Now step 4: extract the mutation in the format "L100G". Step 5: save the result to JSON. Also we need to save intermediate results to the temporary directory.

Let's first save the wild-type sequence and mutation to a JSON file.

<execute>
import json

# Prepare data
result = {
    "wild_type_sequence": wild_type_seq,
    "mutation": f"{differences[0][1]}{differences[0][0]}{differences[0][2]}"  # e.g., L100G
}

print("Result to be saved:")
print(json.dumps(result, indent=2))

# Save to output JSON
output_json = "/root/autodl-tmp/biomni_v20260208_pred_results/deepseek-v3.2-fast/m2or_annotate.json"
os.makedirs(os.path.dirname(output_json), exist_ok=True)
with open(output_json, 'w') as f:
    json.dump(result, f, indent=2)
print(f"Result saved to {output_json}")
</execute>
<observation>NameError("name 'wild_type_seq' is not defined")</observation>
I need to run everything in a single block to avoid variable scope issues. Let's do a complete script.

<execute>
import os
import json
from Bio import ExPASy
from Bio import SeqIO

# Define paths
fasta_path = "benchmark/dataset/M2OR/mutant_M2OR.fasta"
output_json = "/root/autodl-tmp/biomni_v20260208_pred_results/deepseek-v3.2-fast/m2or_annotate.json"
tmp_dir = "/root/autodl-tmp/biomni_v20260208_tmp/deepseek-v3.2-fast/m2or_annotate"

# Create directories
os.makedirs(tmp_dir, exist_ok=True)
os.makedirs(os.path.dirname(output_json), exist_ok=True)

# Step 1: Read mutant sequence
mutant_record = list(SeqIO.parse(fasta_path, "fasta"))[0]
mutant_seq = str(mutant_record.seq)
print(f"Mutant sequence length: {len(mutant_seq)}")

# Step 2: Fetch wild-type sequence
accession = "P08172"
try:
    handle = ExPASy.get_sprot_raw(accession)
    record = SeqIO.read(handle, "swiss")
    handle.close()
    wild_type_seq = str(record.seq)
    print(f"Wild-type sequence length: {len(wild_type_seq)}")
except Exception as e:
    print(f"Error fetching from ExPASy: {e}")
    wild_type_seq = None
    # If fetch fails, we could use a local backup, but for now exit
    exit(1)

# Step 3: Compare sequences
differences = []
for i, (wt, mt) in enumerate(zip(wild_type_seq, mutant_seq)):
    if wt != mt:
        differences.append((i+1, wt, mt))  # 1-indexed position

print(f"Number of differences: {len(differences)}")
if differences:
    print("Differences found:")
    for pos, wt, mt in differences:
        print(f"Position {pos}: wild-type '{wt}' -> mutant '{mt}'")
else:
    print("Sequences are identical.")

# Step 4: Prepare result
if len(differences) == 1:
    mutation = f"{differences[0][1]}{differences[0][0]}{differences[0][2]}"
else:
    # If multiple differences, we need to decide how to represent; but task says single point mutation
    mutation = "multiple"
    print("Warning: More than one difference found.")

result = {
    "wild_type_sequence": wild_type_seq,
    "mutation": mutation
}

print("\nResult to be saved:")
print(json.dumps(result, indent=2))

# Save to output JSON
with open(output_json, 'w') as f:
    json.dump(result, f, indent=2)
print(f"\nResult saved to {output_json}")

# Step 5: Save intermediate results to tmp_dir
# Save wild-type and mutant sequences as FASTA for reference
wild_type_fasta = os.path.join(tmp_dir, "wild_type.fasta")
with open(wild_type_fasta, 'w') as f:
    f.write(f">sp|{accession}|CHRM2_HUMAN_wild\n{wild_type_seq}\n")
print(f"Wild-type FASTA saved to {wild_type_fasta}")

mutant_fasta = os.path.join(tmp_dir, "mutant.fasta")
with open(mutant_fasta, 'w') as f:
    f.write(f">sp|{accession}|CHRM2_HUMAN_mutant\n{mutant_seq}\n")
print(f"Mutant FASTA saved to {mutant_fasta}")

# Save differences as CSV
diff_csv = os.path.join(tmp_dir, "differences.csv")
with open(diff_csv, 'w') as f:
    f.write("position,wild_type,mutant\n")
    for pos, wt, mt in differences:
        f.write(f"{pos},{wt},{mt}\n")
print(f"Differences CSV saved to {diff_csv}")
</execute>
<observation>Mutant sequence length: 466
Wild-type sequence length: 466
Number of differences: 1
Differences found:
Position 100: wild-type 'L' -> mutant 'G'

Result to be saved:
{
  "wild_type_sequence": "MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWLALDYVVSNASVMNLLIISFDRYFCVTKPLTYPVKRTTKMAGMMIAAAWVLSFILWAPAILFWQFIVGVRTVEDGECYIQFFSNAAVTFGTAIAAFYLPVIIMTVLYWHISRASKSRIKKDKKEPVANQDPVSPSLVQGRIVKPNNNNMPSSDDGLEHNKIQNGKAPRDPVTENCVQGEEKESSNDSTSVSAVASNMRDDEITQDENTVSTSLGHSKDENSKQTCIRIGTKTPKSDSCTPTNTTVEVVGSSGQNGDEKQNIVARKIVKMTKQPAKKKPPPSREKKVTRTILAILLAFIITWAPYNVMVLINTFCAPCIPNTVWTIGYWLCYINSTINPACYALCNATFKKTFKHLLMCHYKNIGATR",
  "mutation": "L100G"
}

Result saved to /root/autodl-tmp/biomni_v20260208_pred_results/deepseek-v3.2-fast/m2or_annotate.json
Wild-type FASTA saved to /root/autodl-tmp/biomni_v20260208_tmp/deepseek-v3.2-fast/m2or_annotate/wild_type.fasta
Mutant FASTA saved to /root/autodl-tmp/biomni_v20260208_tmp/deepseek-v3.2-fast/m2or_annotate/mutant.fasta
Differences CSV saved to /root/autodl-tmp/biomni_v20260208_tmp/deepseek-v3.2-fast/m2or_annotate/differences.csv
</observation>
Excellent! All steps have been completed successfully. The mutation is L100G. The result has been saved to the required JSON file, and intermediate files have been saved to the temporary directory.

Now I'll update the plan checklist.

**Updated Plan:**
1. [✓] Locate the FASTA file and examine its content.
2. [✓] Retrieve the canonical wild-type sequence from UniProt accession P08172.
3. [✓] Align the mutant sequence with the wild-type sequence to identify the single point mutation.
4. [✓] Extract the mutation in the format like "A100G" (wild-type residue, position, mutant residue).
5. [✓] Save the result to the specified JSON file with both wild_type_sequence and mutation keys.
6. [✓] Ensure intermediate results are saved to the specified temporary directory.

All steps are completed. Now I can provide the final solution.

<solution>
{
  "wild_type_sequence": "MNNSTNSSNNSLALTSPYKTFEVVFIVLVAGSLSLVTIIGNILVMVSIKVNRHLQTVNNYFLFSLACADLIIGVFSMNLYTLYTVIGYWPLGPVVCDLWLALDYVVSNASVMNLLIISFDRYFCVTKPLTYPVKRTTKMAGMMIAAAWVLSFILWAPAILFWQFIVGVRTVEDGECYIQFFSNAAVTFGTAIAAFYLPVIIMTVLYWHISRASKSRIKKDKKEPVANQDPVSPSLVQGRIVKPNNNNMPSSDDGLEHNKIQNGKAPRDPVTENCVQGEEKESSNDSTSVSAVASNMRDDEITQDENTVSTSLGHSKDENSKQTCIRIGTKTPKSDSCTPTNTTVEVVGSSGQNGDEKQNIVARKIVKMTKQPAKKKPPPSREKKVTRTILAILLAFIITWAPYNVMVLINTFCAPCIPNTVWTIGYWLCYINSTINPACYALCNATFKKTFKHLLMCHYKNIGATR",
  "mutation": "L100G"
}
</solution>