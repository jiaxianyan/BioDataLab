Extract a fusion junction peptide sequence. 

Given a full-length fusion protein sequence in `benchmark/dataset/FusionNeoAntigen/full_fusion_protein.fasta` and a breakpoint coordinate in `benchmark/dataset/FusionNeoAntigen/breakpoint.txt`, extract a 27-amino-acid peptide centered on the breakpoint. 

The peptide should consist of 13 amino acids upstream of the breakpoint, the breakpoint amino acid itself, and 13 amino acids downstream. 

Save the resulting peptide sequence in FASTA format to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/fusionneoantigen_annotate.fasta`. 

All intermediate files generated during the extraction process should be stored in `/root/autodl-tmp/biomni_v20260208_tmp/gemini-3-pro-preview/fusionneoantigen_annotate/`.

I will start by creating a plan to extract the fusion junction peptide sequence.

**Plan:**

1.  [ ] Create the output directory `/root/autodl-tmp/biomni_v20260208_tmp/gemini-3-pro-preview/fusionneoantigen_annotate/` for intermediate files and ensure the final output directory exists.
2.  [ ] Read the content of `benchmark/dataset/FusionNeoAntigen/full_fusion_protein.fasta` to get the protein sequence.
3.  [ ] Read the content of `benchmark/dataset/FusionNeoAntigen/breakpoint.txt` to get the breakpoint coordinate.
4.  [ ] Parse the sequence and the coordinate. Assuming the coordinate is 1-based, extract the subsequence: 13 AA before + breakpoint AA + 13 AA after.
5.  [ ] Save the extracted peptide to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/fusionneoantigen_annotate.fasta` in FASTA format.

Let's start by creating the directories and inspecting the input files.

<execute>
#!BASH

# Create directories
mkdir -p /root/autodl-tmp/biomni_v20260208_tmp/gemini-3-pro-preview/fusionneoantigen_annotate/
mkdir -p /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/

# Inspect the input files
echo "--- full_fusion_protein.fasta ---"
cat benchmark/dataset/FusionNeoAntigen/full_fusion_protein.fasta
echo -e "\n--- breakpoint.txt ---"
cat benchmark/dataset/FusionNeoAntigen/breakpoint.txt</execute>
<observation>--- full_fusion_protein.fasta ---
>full_fusion_protein
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBBBBBBBBBBBBBBBBCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

--- breakpoint.txt ---
45
</observation>
I will write a Python script to parse the FASTA file and the breakpoint file, extract the specific 27-amino-acid sequence, and save it to the specified output path.

1. [✓] Create the output directory `/root/autodl-tmp/biomni_v20260208_tmp/gemini-3-pro-preview/fusionneoantigen_annotate/` for intermediate files and ensure the final output directory exists.
2. [✓] Read the content of `benchmark/dataset/FusionNeoAntigen/full_fusion_protein.fasta` to get the protein sequence.
3. [✓] Read the content of `benchmark/dataset/FusionNeoAntigen/breakpoint.txt` to get the breakpoint coordinate.
4. [ ] Parse the sequence and the coordinate in Python. Assuming 1-based indexing, extract the slice. Save the extracted peptide to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/fusionneoantigen_annotate.fasta`.

<execute>
import Bio
from Bio import SeqIO

fasta_file = "benchmark/dataset/FusionNeoAntigen/full_fusion_protein.fasta"
breakpoint_file = "benchmark/dataset/FusionNeoAntigen/breakpoint.txt"
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/fusionneoantigen_annotate.fasta"

# Read sequence
record = next(SeqIO.parse(fasta_file, "fasta"))
full_sequence = str(record.seq)

# Read breakpoint
with open(breakpoint_file, "r") as f:
    breakpoint = int(f.read().strip())

# Extract peptide
# Breakpoint is 1-based. Python is 0-based.
# Breakpoint index in python: breakpoint - 1
# 13 upstream: start index = (breakpoint - 1) - 13
# 13 downstream: end index = (breakpoint - 1) + 13 + 1 (for slice inclusion)

center_index = breakpoint - 1
start_index = center_index - 13
end_index = center_index + 13 + 1

# Handle boundary conditions just in case (though problem implies valid inputs)
start_index = max(0, start_index)
end_index = min(len(full_sequence), end_index)

peptide = full_sequence[start_index:end_index]

print(f"Full sequence length: {len(full_sequence)}")
print(f"Breakpoint (1-based): {breakpoint}")
print(f"Extraction range (0-based): {start_index} to {end_index}")
print(f"Extracted peptide: {peptide}")
print(f"Peptide length: {len(peptide)}")

# Save to file
with open(output_file, "w") as out:
    out.write(f">fusion_junction_peptide\n{peptide}\n")

print(f"Saved to {output_file}")</execute>
<observation>Full sequence length: 90
Breakpoint (1-based): 45
Extraction range (0-based): 31 to 58
Extracted peptide: BBBBBBBBBBBBBBBBBBBBBBBBBBB
Peptide length: 27
Saved to /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/fusionneoantigen_annotate.fasta
</observation>
The extracted fusion junction peptide has been saved to the specified path.

<solution> /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-pro-preview/fusionneoantigen_annotate.fasta </solution>