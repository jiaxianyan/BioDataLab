Filter the provided SNP data in `benchmark/dataset/PGS-Depot/sample.vcf`. 

The filtering criteria are: remove multi-allelic SNPs, remove SNPs with a minor allele frequency (MAF) less than 0.05, and remove SNPs with a genotype missing rate greater than 0.2. 

Save the resulting filtered data as a VCF file named `/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7/pgs_depot_refinement.vcf`.

All intermediate steps should be saved in `/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement` directory.

I'll help you filter the SNP data according to the specified criteria. Let me start by creating a plan and then executing it step by step.

**Plan:**

1. [ ] Check if the input VCF file exists and examine its structure
2. [ ] Create necessary directories for output and intermediate files
3. [ ] Read the VCF file and extract variant information
4. [ ] Filter multi-allelic SNPs and save intermediate result
5. [ ] Calculate MAF and filter SNPs with MAF < 0.05, save intermediate result
6. [ ] Calculate genotype missing rate and filter SNPs with missing rate > 0.2, save intermediate result
7. [ ] Save the final filtered VCF file

Let me start executing:

<execute>
import os
import pysam
import numpy as np

# Step 1: Check if input file exists
input_vcf = "benchmark/dataset/PGS-Depot/sample.vcf"
print(f"Checking if input file exists: {input_vcf}")
print(f"File exists: {os.path.exists(input_vcf)}")

if os.path.exists(input_vcf):
    # Examine VCF structure
    print("\nReading VCF header...")
    vcf_reader = pysam.VariantFile(input_vcf)
    print(f"Number of samples: {len(vcf_reader.header.samples)}")
    print(f"Sample names: {list(vcf_reader.header.samples)}")
    
    # Count total variants
    total_variants = sum(1 for _ in vcf_reader.fetch())
    print(f"Total variants in file: {total_variants}")
    vcf_reader.close()
</execute>
<observation>Checking if input file exists: benchmark/dataset/PGS-Depot/sample.vcf
File exists: True

Reading VCF header...
Number of samples: 3
Sample names: ['NA00001', 'NA00002', 'NA00003']
Total variants in file: 9
</observation>
<execute>
# Step 2: Create necessary directories
output_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7"
intermediate_dir = "/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement"

os.makedirs(output_dir, exist_ok=True)
os.makedirs(intermediate_dir, exist_ok=True)

print(f"Created output directory: {output_dir}")
print(f"Created intermediate directory: {intermediate_dir}")

# Step 3 & 4: Read VCF and filter multi-allelic SNPs
print("\nStep 4: Filtering multi-allelic SNPs...")

vcf_reader = pysam.VariantFile(input_vcf)
output_filtered = os.path.join(intermediate_dir, "step1_filtered_multiallelic.vcf")
vcf_writer = pysam.VariantFile(output_filtered, 'w', header=vcf_reader.header)

multiallelic_count = 0
passed_count = 0

for record in vcf_reader.fetch():
    # Check if multi-allelic (more than 2 alleles including reference)
    if len(record.alleles) > 2:
        multiallelic_count += 1
        print(f"  Skipping multi-allelic variant: {record.chrom}:{record.pos} {record.alleles}")
        continue
    
    vcf_writer.write(record)
    passed_count += 1

vcf_reader.close()
vcf_writer.close()

print(f"Multi-allelic SNPs removed: {multiallelic_count}")
print(f"Variants after multi-allelic filter: {passed_count}")
print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>NameError("name 'os' is not defined")</observation>
<execute>
import os
import pysam
import numpy as np

# Step 2: Create necessary directories
output_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7"
intermediate_dir = "/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement"

os.makedirs(output_dir, exist_ok=True)
os.makedirs(intermediate_dir, exist_ok=True)

print(f"Created output directory: {output_dir}")
print(f"Created intermediate directory: {intermediate_dir}")

# Step 4: Filter multi-allelic SNPs
print("\nStep 4: Filtering multi-allelic SNPs...")

input_vcf = "benchmark/dataset/PGS-Depot/sample.vcf"
output_filtered = os.path.join(intermediate_dir, "step1_filtered_multiallelic.vcf")

vcf_reader = pysam.VariantFile(input_vcf)
vcf_writer = pysam.VariantFile(output_filtered, 'w', header=vcf_reader.header)

multiallelic_count = 0
passed_count = 0

for record in vcf_reader.fetch():
    # Check if multi-allelic (more than 2 alleles including reference)
    if len(record.alleles) > 2:
        multiallelic_count += 1
        print(f"  Skipping multi-allelic variant: {record.chrom}:{record.pos} {record.alleles}")
        continue
    
    vcf_writer.write(record)
    passed_count += 1

vcf_reader.close()
vcf_writer.close()

print(f"Multi-allelic SNPs removed: {multiallelic_count}")
print(f"Variants after multi-allelic filter: {passed_count}")
print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>OSError(22, "Can't write record: Invalid argument")</observation>
<execute>
import os

# Let's first check the VCF file structure
input_vcf = "benchmark/dataset/PGS-Depot/sample.vcf"
print("Checking VCF file content (first 20 lines):")
with open(input_vcf, 'r') as f:
    for i, line in enumerate(f):
        if i < 20:
            print(line.strip())
        else:
            break
</execute>
<observation>Checking VCF file content (first 20 lines):
##fileformat=VCFv4.0
##fileDate=20090805
##source=myImputationProgramV3.1
##reference=1000GenomesPilot-NCBI36
##phasing=partial
##INFO=<ID=NS,Number=1,Type=Integer,Description="Number of Samples With Data">
##INFO=<ID=AN,Number=1,Type=Integer,Description="Total number of alleles in called genotypes">
##INFO=<ID=AC,Number=.,Type=Integer,Description="Allele count in genotypes, for each ALT allele, in the same order as listed">
##INFO=<ID=DP,Number=1,Type=Integer,Description="Total Depth">
##INFO=<ID=AF,Number=.,Type=Float,Description="Allele Frequency">
##INFO=<ID=AA,Number=1,Type=String,Description="Ancestral Allele">
##INFO=<ID=DB,Number=0,Type=Flag,Description="dbSNP membership, build 129">
##INFO=<ID=H2,Number=0,Type=Flag,Description="HapMap2 membership">
##FILTER=<ID=q10,Description="Quality below 10">
##FILTER=<ID=s50,Description="Less than 50% of samples have data">
##FORMAT=<ID=GT,Number=1,Type=String,Description="Genotype">
##FORMAT=<ID=GQ,Number=1,Type=Integer,Description="Genotype Quality">
##FORMAT=<ID=DP,Number=1,Type=Integer,Description="Read Depth">
##FORMAT=<ID=HQ,Number=2,Type=Integer,Description="Haplotype Quality">
##ALT=<ID=DEL:ME:ALU,Description="Deletion of ALU element">
</observation>
<execute>
# Check the variant records
print("\nChecking variant records:")
with open(input_vcf, 'r') as f:
    for line in f:
        if not line.startswith('#'):
            print(line.strip())
            # Print a few more records
            for i, line in enumerate(f):
                if i < 5:
                    print(line.strip())
            break
</execute>
<observation>NameError("name 'input_vcf' is not defined")</observation>
I need to redefine the input_vcf variable since it was lost in the previous error. Let me continue checking the variant records.</think><execute>
import os

input_vcf = "benchmark/dataset/PGS-Depot/sample.vcf"

# Check the variant records
print("\nChecking variant records:")
with open(input_vcf, 'r') as f:
    for line in f:
        if not line.startswith('#'):
            print(line.strip())
            # Print a few more records
            for i, line in enumerate(f):
                if i < 5:
                    print(line.strip())
            break
</execute>
<observation>
Checking variant records:
19	111	.	A	C	9.6	.	.	GT:HQ	0|0:10,10	0|0:10,10	0/1:3,3
19	112	.	A	G	10	.	.	GT:HQ	0|0:10,10	0|0:10,10	0/1:3,3
20	14370	rs6054257	G	A	29	PASS	NS=3;DP=14;AF=0.5;DB;H2	GT:GQ:DP:HQ	0|0:48:1:51,51	1|0:48:8:51,51	1/1:43:5:.,.
20	17330	.	T	A	3	q10	NS=3;DP=11;AF=0.017	GT:GQ:DP:HQ	0|0:49:3:58,50	0|1:3:5:65,3	0/0:41:3:.,.
20	1110696	rs6040355	A	G,T	67	PASS	NS=2;DP=10;AF=0.333,0.667;AA=T;DB	GT:GQ:DP:HQ	1|2:21:6:23,27	2|1:2:0:18,2	2/2:35:4:.,.
20	1230237	.	T	.	47	PASS	NS=3;DP=13;AA=T	GT:GQ:DP:HQ	0|0:54:.:56,60	0|0:48:4:51,51	0/0:61:2:.,.
</observation>
<execute>
import os
import pysam

input_vcf = "benchmark/dataset/PGS-Depot/sample.vcf"
intermediate_dir = "/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement"
output_dir = "/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7"

os.makedirs(intermediate_dir, exist_ok=True)
os.makedirs(output_dir, exist_ok=True)

# Step 4: Filter multi-allelic SNPs using a different approach
print("Step 4: Filtering multi-allelic SNPs...")

output_filtered = os.path.join(intermediate_dir, "step1_filtered_multiallelic.vcf")

# Read header and write to output
with open(input_vcf, 'r') as infile, open(output_filtered, 'w') as outfile:
    multiallelic_count = 0
    passed_count = 0
    
    for line in infile:
        if line.startswith('#'):
            outfile.write(line)
        else:
            # Parse variant line
            fields = line.strip().split('\t')
            ref = fields[3]
            alt = fields[4]
            
            # Check if multi-allelic (ALT contains comma or is empty)
            if ',' in alt or alt == '.':
                multiallelic_count += 1
                print(f"  Skipping multi-allelic variant: {fields[0]}:{fields[1]} REF={ref} ALT={alt}")
                continue
            
            outfile.write(line)
            passed_count += 1

print(f"Multi-allelic SNPs removed: {multiallelic_count}")
print(f"Variants after multi-allelic filter: {passed_count}")
print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>Step 4: Filtering multi-allelic SNPs...
  Skipping multi-allelic variant: 20:1110696 REF=A ALT=G,T
  Skipping multi-allelic variant: 20:1230237 REF=T ALT=.
  Skipping multi-allelic variant: 20:1234567 REF=G ALT=GA,GAC
  Skipping multi-allelic variant: 20:1235237 REF=T ALT=.
  Skipping multi-allelic variant: X:10 REF=AC ALT=A,ATG
Multi-allelic SNPs removed: 5
Variants after multi-allelic filter: 4
Saved intermediate result to: /root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement/step1_filtered_multiallelic.vcf
</observation>
<execute>
# Step 5: Calculate MAF and filter SNPs with MAF < 0.05
print("\nStep 5: Calculating MAF and filtering SNPs with MAF < 0.05...")

input_vcf = os.path.join(intermediate_dir, "step1_filtered_multiallelic.vcf")
output_filtered = os.path.join(intermediate_dir, "step2_filtered_maf.vcf")

with open(input_vcf, 'r') as infile, open(output_filtered, 'w') as outfile:
    # Write header first
    header_lines = []
    for line in infile:
        if line.startswith('#'):
            header_lines.append(line)
            outfile.write(line)
        else:
            break
    
    # Now process variants
    # Reset file pointer to after header
    infile.seek(0)
    for line in infile:
        if line.startswith('#'):
            continue
        
        fields = line.strip().split('\t')
        chrom = fields[0]
        pos = fields[1]
        ref = fields[3]
        alt = fields[4]
        
        # Extract genotype data (starting from field 9)
        genotype_fields = fields[9:]
        
        # Count alleles
        total_alleles = 0
        alt_alleles = 0
        
        for gt_field in genotype_fields:
            # Extract genotype (first field before colon)
            gt = gt_field.split(':')[0]
            
            # Parse genotype (e.g., 0|0, 0|1, 1|1, 0/1, etc.)
            alleles = gt.replace('|', '/').split('/')
            
            for allele in alleles:
                if allele != '.':
                    total_alleles += 1
                    if allele == '1':
                        alt_alleles += 1
        
        # Calculate MAF
        if total_alleles > 0:
            maf = min(alt_alleles, total_alleles - alt_alleles) / total_alleles
        else:
            maf = 0.0
        
        print(f"  Variant {chrom}:{pos} - Total alleles: {total_alleles}, Alt alleles: {alt_alleles}, MAF: {maf:.4f}")
        
        # Filter by MAF
        if maf < 0.05:
            print(f"    Skipping due to MAF < 0.05")
            continue
        
        outfile.write(line)

print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>NameError("name 'os' is not defined")</observation>
<execute>
import os

# Step 5: Calculate MAF and filter SNPs with MAF < 0.05
print("\nStep 5: Calculating MAF and filtering SNPs with MAF < 0.05...")

intermediate_dir = "/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement"
input_vcf = os.path.join(intermediate_dir, "step1_filtered_multiallelic.vcf")
output_filtered = os.path.join(intermediate_dir, "step2_filtered_maf.vcf")

with open(input_vcf, 'r') as infile, open(output_filtered, 'w') as outfile:
    # Write header first
    header_lines = []
    for line in infile:
        if line.startswith('#'):
            header_lines.append(line)
            outfile.write(line)
        else:
            break
    
    # Now process variants
    # Reset file pointer to after header
    infile.seek(0)
    for line in infile:
        if line.startswith('#'):
            continue
        
        fields = line.strip().split('\t')
        chrom = fields[0]
        pos = fields[1]
        ref = fields[3]
        alt = fields[4]
        
        # Extract genotype data (starting from field 9)
        genotype_fields = fields[9:]
        
        # Count alleles
        total_alleles = 0
        alt_alleles = 0
        
        for gt_field in genotype_fields:
            # Extract genotype (first field before colon)
            gt = gt_field.split(':')[0]
            
            # Parse genotype (e.g., 0|0, 0|1, 1|1, 0/1, etc.)
            alleles = gt.replace('|', '/').split('/')
            
            for allele in alleles:
                if allele != '.':
                    total_alleles += 1
                    if allele == '1':
                        alt_alleles += 1
        
        # Calculate MAF
        if total_alleles > 0:
            maf = min(alt_alleles, total_alleles - alt_alleles) / total_alleles
        else:
            maf = 0.0
        
        print(f"  Variant {chrom}:{pos} - Total alleles: {total_alleles}, Alt alleles: {alt_alleles}, MAF: {maf:.4f}")
        
        # Filter by MAF
        if maf < 0.05:
            print(f"    Skipping due to MAF < 0.05")
            continue
        
        outfile.write(line)

print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>
Step 5: Calculating MAF and filtering SNPs with MAF < 0.05...
  Variant 19:111 - Total alleles: 6, Alt alleles: 1, MAF: 0.1667
  Variant 19:112 - Total alleles: 6, Alt alleles: 1, MAF: 0.1667
  Variant 20:14370 - Total alleles: 6, Alt alleles: 3, MAF: 0.5000
  Variant 20:17330 - Total alleles: 6, Alt alleles: 1, MAF: 0.1667
Saved intermediate result to: /root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement/step2_filtered_maf.vcf
</observation>
<execute>
# Step 6: Calculate genotype missing rate and filter SNPs with missing rate > 0.2
print("\nStep 6: Calculating genotype missing rate and filtering SNPs with missing rate > 0.2...")

input_vcf = os.path.join(intermediate_dir, "step2_filtered_maf.vcf")
output_filtered = os.path.join(intermediate_dir, "step3_filtered_missing.vcf")

with open(input_vcf, 'r') as infile, open(output_filtered, 'w') as outfile:
    # Write header first
    for line in infile:
        if line.startswith('#'):
            outfile.write(line)
        else:
            break
    
    # Now process variants
    # Reset file pointer to after header
    infile.seek(0)
    for line in infile:
        if line.startswith('#'):
            continue
        
        fields = line.strip().split('\t')
        chrom = fields[0]
        pos = fields[1]
        
        # Extract genotype data (starting from field 9)
        genotype_fields = fields[9:]
        
        # Count missing genotypes
        total_genotypes = len(genotype_fields)
        missing_genotypes = 0
        
        for gt_field in genotype_fields:
            # Extract genotype (first field before colon)
            gt = gt_field.split(':')[0]
            
            # Check if genotype contains missing allele
            if '.' in gt:
                missing_genotypes += 1
        
        # Calculate missing rate
        missing_rate = missing_genotypes / total_genotypes
        
        print(f"  Variant {chrom}:{pos} - Total genotypes: {total_genotypes}, Missing genotypes: {missing_genotypes}, Missing rate: {missing_rate:.4f}")
        
        # Filter by missing rate
        if missing_rate > 0.2:
            print(f"    Skipping due to missing rate > 0.2")
            continue
        
        outfile.write(line)

print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>NameError("name 'os' is not defined")</observation>
<execute>
import os

# Step 6: Calculate genotype missing rate and filter SNPs with missing rate > 0.2
print("\nStep 6: Calculating genotype missing rate and filtering SNPs with missing rate > 0.2...")

intermediate_dir = "/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement"
input_vcf = os.path.join(intermediate_dir, "step2_filtered_maf.vcf")
output_filtered = os.path.join(intermediate_dir, "step3_filtered_missing.vcf")

with open(input_vcf, 'r') as infile, open(output_filtered, 'w') as outfile:
    # Write header first
    for line in infile:
        if line.startswith('#'):
            outfile.write(line)
        else:
            break
    
    # Now process variants
    # Reset file pointer to after header
    infile.seek(0)
    for line in infile:
        if line.startswith('#'):
            continue
        
        fields = line.strip().split('\t')
        chrom = fields[0]
        pos = fields[1]
        
        # Extract genotype data (starting from field 9)
        genotype_fields = fields[9:]
        
        # Count missing genotypes
        total_genotypes = len(genotype_fields)
        missing_genotypes = 0
        
        for gt_field in genotype_fields:
            # Extract genotype (first field before colon)
            gt = gt_field.split(':')[0]
            
            # Check if genotype contains missing allele
            if '.' in gt:
                missing_genotypes += 1
        
        # Calculate missing rate
        missing_rate = missing_genotypes / total_genotypes
        
        print(f"  Variant {chrom}:{pos} - Total genotypes: {total_genotypes}, Missing genotypes: {missing_genotypes}, Missing rate: {missing_rate:.4f}")
        
        # Filter by missing rate
        if missing_rate > 0.2:
            print(f"    Skipping due to missing rate > 0.2")
            continue
        
        outfile.write(line)

print(f"Saved intermediate result to: {output_filtered}")
</execute>
<observation>
Step 6: Calculating genotype missing rate and filtering SNPs with missing rate > 0.2...
  Variant 19:111 - Total genotypes: 3, Missing genotypes: 0, Missing rate: 0.0000
  Variant 19:112 - Total genotypes: 3, Missing genotypes: 0, Missing rate: 0.0000
  Variant 20:14370 - Total genotypes: 3, Missing genotypes: 0, Missing rate: 0.0000
  Variant 20:17330 - Total genotypes: 3, Missing genotypes: 0, Missing rate: 0.0000
Saved intermediate result to: /root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement/step3_filtered_missing.vcf
</observation>
<execute>
# Step 7: Save the final filtered VCF file
print("\nStep 7: Saving final filtered VCF file...")

input_vcf = os.path.join(intermediate_dir, "step3_filtered_missing.vcf")
final_output = "/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7/pgs_depot_refinement.vcf"

# Copy the final filtered file to the output location
with open(input_vcf, 'r') as infile, open(final_output, 'w') as outfile:
    for line in infile:
        outfile.write(line)

print(f"Final filtered VCF saved to: {final_output}")

# Print summary
print("\n" + "="*60)
print("FILTERING SUMMARY")
print("="*60)
print(f"Input file: benchmark/dataset/PGS-Depot/sample.vcf")
print(f"Output file: {final_output}")
print(f"\nIntermediate files saved in: {intermediate_dir}")
print("  - step1_filtered_multiallelic.vcf (after removing multi-allelic SNPs)")
print("  - step2_filtered_maf.vcf (after removing SNPs with MAF < 0.05)")
print("  - step3_filtered_missing.vcf (after removing SNPs with missing rate > 0.2)")

# Count final variants
with open(final_output, 'r') as f:
    variant_count = sum(1 for line in f if not line.startswith('#'))
print(f"\nFinal number of variants: {variant_count}")
print("="*60)
</execute>
<observation>NameError("name 'os' is not defined")</observation>
<execute>
import os

# Step 7: Save the final filtered VCF file
print("\nStep 7: Saving final filtered VCF file...")

intermediate_dir = "/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement"
input_vcf = os.path.join(intermediate_dir, "step3_filtered_missing.vcf")
final_output = "/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7/pgs_depot_refinement.vcf"

# Copy the final filtered file to the output location
with open(input_vcf, 'r') as infile, open(final_output, 'w') as outfile:
    for line in infile:
        outfile.write(line)

print(f"Final filtered VCF saved to: {final_output}")

# Print summary
print("\n" + "="*60)
print("FILTERING SUMMARY")
print("="*60)
print(f"Input file: benchmark/dataset/PGS-Depot/sample.vcf")
print(f"Output file: {final_output}")
print(f"\nIntermediate files saved in: {intermediate_dir}")
print("  - step1_filtered_multiallelic.vcf (after removing multi-allelic SNPs)")
print("  - step2_filtered_maf.vcf (after removing SNPs with MAF < 0.05)")
print("  - step3_filtered_missing.vcf (after removing SNPs with missing rate > 0.2)")

# Count final variants
with open(final_output, 'r') as f:
    variant_count = sum(1 for line in f if not line.startswith('#'))
print(f"\nFinal number of variants: {variant_count}")
print("="*60)
</execute>
<observation>
Step 7: Saving final filtered VCF file...
Final filtered VCF saved to: /root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7/pgs_depot_refinement.vcf

============================================================
FILTERING SUMMARY
============================================================
Input file: benchmark/dataset/PGS-Depot/sample.vcf
Output file: /root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7/pgs_depot_refinement.vcf

Intermediate files saved in: /root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement
  - step1_filtered_multiallelic.vcf (after removing multi-allelic SNPs)
  - step2_filtered_maf.vcf (after removing SNPs with MAF < 0.05)
  - step3_filtered_missing.vcf (after removing SNPs with missing rate > 0.2)

Final number of variants: 4
============================================================
</observation>
Each response must include thinking process followed by either <execute> or <solution> tag. But there are no tags in the current response. Please follow the instruction, fix and regenerate the response again.
Thinking: The task has been completed successfully. I've filtered the SNP data according to all three criteria: removed multi-allelic SNPs, filtered SNPs with MAF < 0.05, and filtered SNPs with genotype missing rate > 0.2. The final filtered VCF file has been saved to the specified location, and all intermediate files have been saved in the designated directory. I should now provide a solution summary with the proper tag format.

<solution>
SNP data filtering completed successfully!

**Input**: `benchmark/dataset/PGS-Depot/sample.vcf` (9 variants)

**Filtering Results**:
1. Multi-allelic filter: Removed 5 variants (had multiple ALT alleles or empty ALT)
2. MAF filter: All 4 remaining variants passed (MAF >= 0.05)
3. Missing rate filter: All 4 remaining variants passed (missing rate <= 0.2)

**Output**: `/root/autodl-tmp/biomni_v20260208_pred_results/glm-4.7/pgs_depot_refinement.vcf` (4 variants)

**Intermediate files saved in**: `/root/autodl-tmp/biomni_v20260208_tmp/glm-4.7/pgs_depot_refinement/`
- step1_filtered_multiallelic.vcf (after removing multi-allelic SNPs)
- step2_filtered_maf.vcf (after removing SNPs with MAF < 0.05)
- step3_filtered_missing.vcf (after removing SNPs with missing rate > 0.2)
</solution>