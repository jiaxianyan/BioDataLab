Process the provided CDS sequences in `benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna`. 

Filter out sequences that meet any of the following criteria: 1) length is not a multiple of 3; 2) does not start with an "ATG" codon; 3) does not end with a standard stop codon ("TAA", "TAG", or "TGA"); 4) contains an internal stop codon. 

Save the remaining valid sequences to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/compodynamics_integration.fna`.

All temp data should be save in `/root/autodl-tmp/biomni_v20260208_tmp/gemini-3-flash-preview/compodynamics_integration`.

I will process the CDS sequences in the provided file by filtering them based on the specified biological criteria.

### Plan
1. [ ] Check if the input file exists and create the temporary and output directories.
2. [ ] Define a filtering function to check:
    *   Length is a multiple of 3.
    *   Sequence starts with "ATG".
    *   Sequence ends with a standard stop codon ("TAA", "TAG", "TGA").
    *   No internal stop codons (excluding the terminal one).
3. [ ] Read the input sequences, apply the filter, and count valid/invalid records.
4. [ ] Save the valid sequences to the specified output file.

---

### Step 1: Check input and create directories
I will first check the existence of the input file and set up the necessary directory structure.

<execute>
#!BASH
# Check if input file exists
INPUT_FILE="benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna"
TMP_DIR="/root/autodl-tmp/biomni_v20260208_tmp/gemini-3-flash-preview/compodynamics_integration"
OUTPUT_DIR="/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview"

if [ -f "$INPUT_FILE" ]; then
    echo "Input file exists."
else
    echo "Input file NOT found!"
fi

# Create directories
mkdir -p "$TMP_DIR"
mkdir -p "$OUTPUT_DIR"
echo "Directories created/checked."</execute>
<observation>Input file exists.
Directories created/checked.
</observation>
### Plan
1. [âœ“] Check if the input file exists and create the temporary and output directories.
2. [ ] Define a filtering function to check:
    *   Length is a multiple of 3.
    *   Sequence starts with "ATG".
    *   Sequence ends with a standard stop codon ("TAA", "TAG", "TGA").
    *   No internal stop codons (excluding the terminal one).
3. [ ] Read the input sequences, apply the filter, and count valid/invalid records.
4. [ ] Save the valid sequences to the specified output file.

---

### Step 2 & 3: Filter sequences and Save results
I will now use Biopython to parse the FASTA file, apply the filtering criteria, and write the valid sequences to the destination.

<execute>
from Bio import SeqIO

input_file = "benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna"
output_file = "/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/compodynamics_integration.fna"

valid_sequences = []
stats = {
    "total": 0,
    "not_multiple_3": 0,
    "no_start_atg": 0,
    "no_stop_codon": 0,
    "internal_stop": 0,
    "valid": 0
}

stop_codons = {"TAA", "TAG", "TGA"}

for record in SeqIO.parse(input_file, "fasta"):
    stats["total"] += 1
    seq = str(record.seq).upper()
    length = len(seq)
    
    # 1) Length is a multiple of 3
    if length % 3 != 0:
        stats["not_multiple_3"] += 1
        continue
        
    # 2) Starts with ATG
    if not seq.startswith("ATG"):
        stats["no_start_atg"] += 1
        continue
        
    # 3) Ends with a standard stop codon
    if seq[-3:] not in stop_codons:
        stats["no_stop_codon"] += 1
        continue
        
    # 4) Contains an internal stop codon
    has_internal_stop = False
    for i in range(0, length - 3, 3):
        codon = seq[i:i+3]
        if codon in stop_codons:
            has_internal_stop = True
            break
    
    if has_internal_stop:
        stats["internal_stop"] += 1
        continue
        
    # If all criteria met
    valid_sequences.append(record)
    stats["valid"] += 1

# Write valid sequences
with open(output_file, "w") as out_handle:
    SeqIO.write(valid_sequences, out_handle, "fasta")

print("Processing complete.")
print(f"Total records processed: {stats['total']}")
print(f"Failed length check (multiple of 3): {stats['not_multiple_3']}")
print(f"Failed start codon (ATG): {stats['no_start_atg']}")
print(f"Failed stop codon (TAA/TAG/TGA): {stats['no_stop_codon']}")
print(f"Failed internal stop codon check: {stats['internal_stop']}")
print(f"Valid sequences saved: {stats['valid']}")
print(f"Output file: {output_file}")</execute>
<observation>Processing complete.
Total records processed: 2701
Failed length check (multiple of 3): 54
Failed start codon (ATG): 642
Failed stop codon (TAA/TAG/TGA): 14
Failed internal stop codon check: 7
Valid sequences saved: 1984
Output file: /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/compodynamics_integration.fna
</observation>
The processing of the CDS sequences from `benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna` is complete. 

### Processing Summary:
1.  **Input File**: `benchmark/dataset/CompoDynamics/GCF_009428885.1_ASM942888v1_cds_from_genomic.fna`
2.  **Filtering Criteria Applied**:
    *   Sequence length must be a multiple of 3.
    *   Sequence must start with the "ATG" start codon.
    *   Sequence must end with a standard stop codon ("TAA", "TAG", or "TGA").
    *   Sequence must not contain any internal stop codons (excluding the terminal one).
3.  **Statistics**:
    *   Total records processed: 2701
    *   Failed length check: 54
    *   Failed start codon check (non-ATG): 642
    *   Failed stop codon check (non-standard): 14
    *   Failed internal stop codon check: 7
    *   **Valid sequences retained: 1984**

The filtered sequences have been saved to the requested output location.

The answer is <solution>/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/compodynamics_integration.fna</solution>