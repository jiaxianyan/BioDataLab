Perform quality control on a single-cell RNA-seq dataset. 

Load the raw PBMC3k dataset from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`. 

First, filter out cells that express fewer than 200 genes. 

Second, filter out cells that express more than 2500 genes. 

Third, calculate the percentage of counts from mitochondrial genes for each cell and remove any cell where this percentage exceeds 5%.

Finally, save the filtered data as an AnnData object to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad`.

All intermediate results should be stored in the `/root/autodl-tmp/biomni_v20260208_tmp/gemini-3-flash-preview/cellcommunet_refinement` directory.

I will perform quality control on the provided single-cell RNA-seq dataset by following these steps:

1. [ ] Create necessary directories for intermediate and final results.
2. [ ] Load the raw AnnData object from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`.
3. [ ] Filter out cells expressing fewer than 200 genes.
4. [ ] Filter out cells expressing more than 2500 genes.
5. [ ] Calculate mitochondrial gene percentage and filter out cells with > 5% mitochondrial content.
6. [ ] Save the processed data to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad`.

First, I will create the directories and check for the existence of the input file.

<execute>
#!BASH
mkdir -p /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/
mkdir -p /root/autodl-tmp/biomni_v20260208_tmp/gemini-3-flash-preview/cellcommunet_refinement

if [ -f "benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad" ]; then
    echo "Input file exists."
else
    echo "Input file NOT found!"
fi</execute>
<observation>Input file exists.
</observation>
1. [✓] Create necessary directories for intermediate and final results. (completed)
2. [ ] Load the raw AnnData object from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`.
3. [ ] Filter out cells expressing fewer than 200 genes.
4. [ ] Filter out cells expressing more than 2500 genes.
5. [ ] Calculate mitochondrial gene percentage and filter out cells with > 5% mitochondrial content.
6. [ ] Save the processed data to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad`.

I will now load the data and perform the filtering steps.

<execute>
import scanpy as sc
import os

# Load data
input_path = "benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad"
print(f"Loading data from {input_path}...")
adata = sc.read_h5ad(input_path)
print(f"Original data shape: {adata.shape}")

# Filter cells with fewer than 200 genes
sc.pp.filter_cells(adata, min_genes=200)
print(f"Shape after filtering < 200 genes: {adata.shape}")

# Filter cells with more than 2500 genes
sc.pp.filter_cells(adata, max_genes=2500)
print(f"Shape after filtering > 2500 genes: {adata.shape}")

# Calculate mitochondrial percentage
# Usually mitochondrial genes start with 'MT-' in human PBMC data
adata.var['mt'] = adata.var_names.str.startswith('MT-')
sc.pp.calculate_qc_metrics(adata, qc_vars=['mt'], percent_top=None, log1p=False, inplace=True)

# Filter cells with > 5% mitochondrial genes
adata = adata[adata.obs.pct_counts_mt < 5, :].copy()
print(f"Shape after filtering > 5% mitochondrial counts: {adata.shape}")

# Save the result
output_path = "/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad"
adata.write(output_path)
print(f"Saved filtered data to {output_path}")</execute>
<observation>Loading data from benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad...
Original data shape: (2700, 32738)
Shape after filtering < 200 genes: (2700, 32738)
Shape after filtering > 2500 genes: (2695, 32738)
Shape after filtering > 5% mitochondrial counts: (2638, 32738)
Saved filtered data to /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad
</observation>
1. [✓] Create necessary directories for intermediate and final results. (completed)
2. [✓] Load the raw AnnData object from `benchmark/dataset/CellCommuNet/pbmc3k_raw.h5ad`. (completed)
3. [✓] Filter out cells expressing fewer than 200 genes. (completed)
4. [✓] Filter out cells expressing more than 2500 genes. (completed)
5. [✓] Calculate mitochondrial gene percentage and filter out cells with > 5% mitochondrial content. (completed)
6. [✓] Save the processed data to `/root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad`. (completed)

The quality control on the PBMC3k dataset has been successfully completed. 
- Original shape: (2700, 32738)
- After filtering cells with < 200 genes: (2700, 32738) (no cells removed in this step)
- After filtering cells with > 2500 genes: (2695, 32738)
- After filtering cells with > 5% mitochondrial counts: (2638, 32738)

The final AnnData object has been saved to:
<solution> /root/autodl-tmp/biomni_v20260208_pred_results/gemini-3-flash-preview/cellcommunet_refinement.h5ad </solution>