Task: |
  # Core Task
  You are a specialized Bioinformatics Agent acting as an expert in antibody sequence annotation and structural numbering. Your core competency is utilizing the ANARCI (Antibody Numbering and Antigen Receptor ClassIfication) tool to parse sequence data, apply standardized numbering schemes, and extract structural loop metrics. Process a FASTA file of antibody sequences using ANARCI to identify chain types, apply IMGT numbering, and calculate CDR lengths.

  # Workflow Instructions
  - `Sequence Parsing & Numbering`: The input is a FASTA file containing antibody sequences with Accession ID in the headers. Please use the `IMGT` numbering scheme.
  - `Chain Classification`: Classify each sequence based on the ANARCI output. Map results to a binary category: H (Heavy Chain) or L (Light Chain).
  - `CDR Length Calculation`: Identify the residue positions for CDR1, CDR2, and CDR3 according to the `IMGT` definition. Calculate the length for each region by counting residues only (exclude gaps).

  # Output Requirements & File Path
  Generate a CSV file with the following columns:
  - "Accession": The Accession ID from the FASTA header.
  - "Numbered_Sequence": The sequence string with `IMGT` numbering gaps.
  - "CDR_Lengths": The formatted length string (e.g., 8_8_12, which means the length of CDR1 is 8, CDR2 is 8, and CDR3 is 12).
  - "Chain_Type": The identified chain (either H or L).
  Input Path: Read the input file from: `benchmark/dataset/PLAbDab/plabdab_annotate_1_input.fasta`
  Save Path: Save the result to: `<r></r>/plabdab_annotate_1.csv`

  # Output Example (For Reference Only)
  Accession,Raw_Sequence,Numbered_Sequence,CDR_Lengths,Chain_Type
  QPY89049.1,EIVLTQSPGTLSLSPGERATLSCRASQSVGSSYLAWYQQKPGQAPRLLIYGAFSRATGIPDRFSGSGSGTDFTLTISRLEPEDFAVYYCQQYGSSPWTFGQGTKVEIK,EIVLTQSPGTLSLSPGERATLSCRASQSVG-----SSYLAWYQQKPGQAPRLLIYGA-------FSRATGIP-DRFSGSG--SGTDFTLTISRLEPEDFAVYYCQQYGS----SPWTFGQGTKVEIK,7_3_9,L
  QEP20941.1,DIQMTQSPSSLSASVGDRVTITCRASQGISNSLAWYQQKPGKAPNLLLYAASRLESGVPSRFSGSGSGTDYTLTISSLQPEDFATYYCQQYYRTPLTFGGGSKVEIK,DIQMTQSPSSLSASVGDRVTITCRASQGI------SNSLAWYQQKPGKAPNLLLYAA-------SRLESGVP-SRFSGSG--SGTDYTLTISSLQPEDFATYYCQQYYR----TPLTFGGGSKVEIK,6_3_9,L


  # Intermediate Results
  All intermediate files generated should be saved in the directly `<t></t>/plabdab_annotate_1`


Verifier: plabdab_annotate_1